# Install and load packages -----------------------------------------------
library(dplyr)
library(ggplot2)
library(car)
library(emmeans)
library(gridExtra)
library(ggtext)
library(multcomp)
library(multcompView)
library(dunn.test)
library(scales)
library(cowplot)
library(effectsize)

# Samples (Outside Curve) -------------------------------------------------
setwd("C:/Users/aeschne2/Box/2020_Carp_Contaminants_Proposal/Illinois River Sampling/FLUIDIGM")
getwd()

expression_data_outside_curve <- read.csv("samples outside curve.csv")

View (expression_data_outside_curve)

# Importing Gene Data -----------------------------------------------------
## Plate 1 -----------------------------------------------------------------
plate1 <- read.csv("Plate_A_liver.csv")
View(plate1)
## Plate 2 -----------------------------------------------------------------
plate2 <- read.csv("Plate_B_gills.csv")
View(plate2)


# Filtering Gene Data ----------------------------------------------------
## Plate 1 -----------------------------------------------------------------
plate1.filtered <- plate1 %>% 
  filter(EvaGreen.Name != "" & 
           Sample.Name != "" &
           Sample.Name != "NTC" &
           Sample.Type != "Standard" &
           Sample.Type != "empty" &
           Sample.Name != "empty" &
           Ct.Call != "Flag" &
           Ct.Value != 999.000000) %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  mutate (CV = (sd(Ct.Value)/mean(Ct.Value))*100) %>%
  ungroup() %>%
  mutate(Tissue = case_when(
    Sample.Name == "1L" ~ "Liver",
    Sample.Name == "2L" ~ "Liver",
    Sample.Name == "3L" ~ "Liver",
    Sample.Name == "4L" ~ "Liver",
    Sample.Name == "5L" ~ "Liver",
    Sample.Name == "6L" ~ "Liver",
    Sample.Name == "7L" ~ "Liver",
    Sample.Name == "8L" ~ "Liver",
    Sample.Name == "9L" ~ "Liver",
    Sample.Name == "10L" ~ "Liver",
    Sample.Name == "11L" ~ "Liver",
    Sample.Name == "12L" ~ "Liver",
    Sample.Name == "13L" ~ "Liver",
    Sample.Name == "14L" ~ "Liver",
    Sample.Name == "15L" ~ "Liver",
    Sample.Name == "16L" ~ "Liver",
    Sample.Name == "17L" ~ "Liver",
    Sample.Name == "18L" ~ "Liver",
    Sample.Name == "19L" ~ "Liver",
    Sample.Name == "20L" ~ "Liver",
    Sample.Name == "21L" ~ "Liver",
    Sample.Name == "22L" ~ "Liver",
    Sample.Name == "23L" ~ "Liver",
    Sample.Name == "24L" ~ "Liver",
    Sample.Name == "25L" ~ "Liver",
    Sample.Name == "26L" ~ "Liver",
    Sample.Name == "27L" ~ "Liver",
    Sample.Name == "28L" ~ "Liver",
    Sample.Name == "29L" ~ "Liver",
    Sample.Name == "30L" ~ "Liver",
    Sample.Name == "31L" ~ "Liver",
    Sample.Name == "32L" ~ "Liver",
    Sample.Name == "33L" ~ "Liver",
    Sample.Name == "34L" ~ "Liver",
    Sample.Name == "35L" ~ "Liver",
    Sample.Name == "36L" ~ "Liver",
    Sample.Name == "37L" ~ "Liver",
    Sample.Name == "38L" ~ "Liver",
    Sample.Name == "39L" ~ "Liver",
    Sample.Name == "40L" ~ "Liver",
    Sample.Name == "41L" ~ "Liver",
    Sample.Name == "42L" ~ "Liver",
    Sample.Name == "43L" ~ "Liver",
    Sample.Name == "44L" ~ "Liver", 
    Sample.Name == "45L" ~ "Liver",
    Sample.Name == "46L" ~ "Liver",
    Sample.Name == "47L" ~ "Liver",
    Sample.Name == "48L" ~ "Liver",
    Sample.Name == "49L" ~ "Liver",
    Sample.Name == "50L" ~ "Liver",
    Sample.Name == "51L" ~ "Liver",
    Sample.Name == "52L" ~ "Liver",
    Sample.Name == "53L" ~ "Liver",
    Sample.Name == "54L" ~ "Liver",
    Sample.Name == "55L" ~ "Liver",
    Sample.Name == "56L" ~ "Liver",
    Sample.Name == "57L" ~ "Liver",
    Sample.Name == "58L" ~ "Liver",
    Sample.Name == "59L" ~ "Liver",
    Sample.Name == "60L" ~ "Liver",
    Sample.Name == "61L" ~ "Liver",
    Sample.Name == "62L" ~ "Liver",
    Sample.Name == "63L" ~ "Liver",
    Sample.Name == "64L" ~ "Liver",
    Sample.Name == "65L" ~ "Liver",
    Sample.Name == "66L" ~ "Liver",
    Sample.Name == "67L" ~ "Liver",
    Sample.Name == "68L" ~ "Liver",
    Sample.Name == "69L" ~ "Liver",
    Sample.Name == "70L" ~ "Liver",
    Sample.Name == "71L" ~ "Liver",
    Sample.Name == "72L" ~ "Liver",
    Sample.Name == "73L" ~ "Liver",
    Sample.Name == "74L" ~ "Liver",
    Sample.Name == "75L" ~ "Liver",
    Sample.Name == "76L" ~ "Liver",
    Sample.Name == "77L" ~ "Liver"))
View(plate1.filtered)
## Plate 2 -----------------------------------------------------------------
plate2.filtered <- plate2 %>% 
  filter(EvaGreen.Name != "" & 
           Sample.Name != "" &
           Sample.Name != "NTC" &
           Sample.Type != "Standard" &
           Sample.Name != "empty" &
           Ct.Call != "Flag" &
           Ct.Value != 999.000000) %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  mutate (CV = (sd(Ct.Value)/mean(Ct.Value))*100) %>%
  ungroup() %>%
  mutate(Tissue = case_when(
    Sample.Name == "1G" ~ "Gill",
    Sample.Name == "2G" ~ "Gill",
    Sample.Name == "3G" ~ "Gill",
    Sample.Name == "4G" ~ "Gill",
    Sample.Name == "5G" ~ "Gill",
    Sample.Name == "6G" ~ "Gill",
    Sample.Name == "7G" ~ "Gill",
    Sample.Name == "8G" ~ "Gill",
    Sample.Name == "9G" ~ "Gill",
    Sample.Name == "10G" ~ "Gill",
    Sample.Name == "11G" ~ "Gill",
    Sample.Name == "12G" ~ "Gill",
    Sample.Name == "13G" ~ "Gill",
    Sample.Name == "14G" ~ "Gill",
    Sample.Name == "15G" ~ "Gill",
    Sample.Name == "16G" ~ "Gill",
    Sample.Name == "17G" ~ "Gill",
    Sample.Name == "18G" ~ "Gill",
    Sample.Name == "19G" ~ "Gill",
    Sample.Name == "20G" ~ "Gill",
    Sample.Name == "21G" ~ "Gill",
    Sample.Name == "22G" ~ "Gill",
    Sample.Name == "23G" ~ "Gill",
    Sample.Name == "24G" ~ "Gill",
    Sample.Name == "25G" ~ "Gill",
    Sample.Name == "26G" ~ "Gill",
    Sample.Name == "27G" ~ "Gill",
    Sample.Name == "28G" ~ "Gill",
    Sample.Name == "29G" ~ "Gill",
    Sample.Name == "30G" ~ "Gill",
    Sample.Name == "31G" ~ "Gill",
    Sample.Name == "33G" ~ "Gill",
    Sample.Name == "34G" ~ "Gill",
    Sample.Name == "35G" ~ "Gill",
    Sample.Name == "36G" ~ "Gill",
    Sample.Name == "37G" ~ "Gill",
    Sample.Name == "38G" ~ "Gill",
    Sample.Name == "39G" ~ "Gill",
    Sample.Name == "40G" ~ "Gill",
    Sample.Name == "41G" ~ "Gill",
    Sample.Name == "42G" ~ "Gill",
    Sample.Name == "43G" ~ "Gill",
    Sample.Name == "44G" ~ "Gill", 
    Sample.Name == "45G" ~ "Gill",
    Sample.Name == "46G" ~ "Gill",
    Sample.Name == "47G" ~ "Gill",
    Sample.Name == "48G" ~ "Gill",
    Sample.Name == "49G" ~ "Gill",
    Sample.Name == "50G" ~ "Gill",
    Sample.Name == "51G" ~ "Gill",
    Sample.Name == "52G" ~ "Gill",
    Sample.Name == "53G" ~ "Gill",
    Sample.Name == "54G" ~ "Gill",
    Sample.Name == "55G" ~ "Gill",
    Sample.Name == "56G" ~ "Gill",
    Sample.Name == "57G" ~ "Gill",
    Sample.Name == "58G" ~ "Gill",
    Sample.Name == "59G" ~ "Gill",
    Sample.Name == "60G" ~ "Gill",
    Sample.Name == "61G" ~ "Gill",
    Sample.Name == "62G" ~ "Gill",
    Sample.Name == "63G" ~ "Gill",
    Sample.Name == "64G" ~ "Gill",
    Sample.Name == "65G" ~ "Gill",
    Sample.Name == "66G" ~ "Gill",
    Sample.Name == "67G" ~ "Gill",
    Sample.Name == "68G" ~ "Gill",
    Sample.Name == "69G" ~ "Gill",
    Sample.Name == "70G" ~ "Gill",
    Sample.Name == "71G" ~ "Gill",
    Sample.Name == "72G" ~ "Gill",
    Sample.Name == "73G" ~ "Gill",
    Sample.Name == "74G" ~ "Gill",
    Sample.Name == "75G" ~ "Gill",
    Sample.Name == "76G" ~ "Gill",
    Sample.Name == "77G" ~ "Gill"))
View(plate2.filtered)
# Combining Plate 1 and Plate 2 --------------------------------------------------
gene.data <- rbind(plate1.filtered,plate2.filtered)

# Remove Samples with High Variability within Replicates --------
gene.data.filtered <- gene.data %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  filter (CV > 5, n() > 1) %>%
  mutate(
    average.ct = mean(Ct.Value, na.rm=T),
    diff = abs(Ct.Value - average.ct),
    diff.greatest = max(diff),
    diff.max = ifelse(diff==diff.greatest,1,0)) %>%
  filter(diff.max == 0) %>%
  mutate(
    CV = (sd(Ct.Value)/mean(Ct.Value))*100) %>%
  filter(n() > 1, CV < 5) 

rows_to_replace <- gene.data %>%
  anti_join(gene.data.filtered, by = c("Sample.Name", "EvaGreen.Name")) #%>%

gene.data <- bind_rows(rows_to_replace, gene.data.filtered)

# Liver -------------------------------------------------------------------
liver <- gene.data %>%
  filter(Tissue=="Liver")
View(liver)

# Gill --------------------------------------------------------------------
gill <- gene.data %>%
  filter(Tissue=="Gill")
View(gill)

#Housekeeping genes ----------------------------------------------------------

## ef1a liver--------------------------------------------------------------------

EF1a.liver <- liver %>%
  filter(EvaGreen.Name %in% c("EF1-a"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$ef1a %in% c("low expression", "high expression", "no expression")]))

View(EF1a.liver)

EF1a.liver.averaged <- EF1a.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(EF1a.liver.averaged)

ef1a_liver_anova_results <- aov((average.ct) ~ Treatment*Season, data = EF1a.liver.averaged)
summary(ef1a_liver_anova_results)
Anova(ef1a_liver_anova_results)

EF1a.liver.boxplot <- ggplot(EF1a.liver.averaged, aes(y=average.ct, x=Treatment, color=Season)) +
  geom_boxplot()

## bactin liver-------------------------------------------------------------------
bactin.liver <- liver %>%
  filter(EvaGreen.Name %in% c("b-ACTIN"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$bactin %in% c("low expression", "high expression", "no expression")]))

View(bactin.liver)

bactin.liver.averaged <- bactin.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(bactin.liver.averaged)

bactin.liver.nospring <- bactin.liver.averaged %>% 
  filter(Season != "Spring")

View(bactin.liver.nospring)

bactin_liver_anova_results <- aov((average.ct) ~ Treatment*Season, data = bactin.liver.averaged)
summary(bactin_liver_anova_results)
Anova(bactin_liver_anova_results)

bactin.liver.boxplot <- ggplot(bactin.liver.averaged, aes(y=average.ct, x=Treatment, color=Season)) +
  geom_boxplot()

## 18s liver-------------------------------------------------------------------
rna18.liver <- liver %>%
  filter(EvaGreen.Name %in% c("18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))

View(rna18.liver)

rna18.liver.averaged <- rna18.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(rna18.liver.averaged)

rna18.liver.spring <- rna18.liver.averaged %>% 
  filter(Season != "Fall")

View(rna18.liver.spring)

rna18_liver_anova_results <- aov((average.ct) ~ Treatment*Season, data = rna18.liver.spring)
summary(rna18_liver_anova_results)
Anova(rna18_liver_anova_results)

rna18.liver.boxplot <- ggplot(rna18.liver.spring, aes(y=average.ct, x=Treatment, color=Season)) +
  geom_boxplot()

## bactin gill-------------------------------------------------------------------
bactin.gill <- gill %>%
  filter(EvaGreen.Name %in% c("b-ACTIN"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$bactin %in% c("low expression", "high expression", "no expression")]))

View(bactin.gill)

bactin.gill.averaged <- bactin.gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(bactin.gill.averaged)

bactin_gill_anova_results <- aov((average.ct) ~ Treatment*Season, data = bactin.gill.averaged)
summary(bactin_gill_anova_results)
Anova(bactin_gill_anova_results)

bactin.gill.boxplot <- ggplot(bactin.gill.averaged, aes(y=average.ct, x=Treatment, color=Season)) +
  geom_boxplot()

## ef1a gill-------------------------------------------------------------------
EF1a.gill <- gill %>%
  filter(EvaGreen.Name %in% c("EF1-a"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$ef1a %in% c("low expression", "high expression", "no expression")]))

View(EF1a.gill)

EF1a.gill.averaged <- EF1a.gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(EF1a.gill.averaged)

EF1a_gill_anova_results <- aov((average.ct) ~ Treatment*Season, data = EF1a.gill.averaged)
summary(EF1a_gill_anova_results)
Anova(EF1a_gill_anova_results)

EF1a.gill.boxplot <- ggplot(EF1a.gill.averaged, aes(y=average.ct, x=Treatment, color=Season)) +
  geom_boxplot()
## 18s gill-------------------------------------------------------------------
rna18.gill <- gill %>%
  filter(EvaGreen.Name %in% c("18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))

View(rna18.gill)

rna18.gill.averaged <- rna18.gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(rna18.gill.averaged)



rna18_gill_anova_results <- aov((average.ct) ~ Treatment*Season, data = rna18.gill.averaged)
summary(rna18_gill_anova_results)
Anova(rna18_gill_anova_results)

rna18.gill.boxplot <- ggplot(rna18.gill.averaged, aes(y=average.ct, x=Treatment, color=Season)) +
  geom_boxplot()

# Fold Change Data -------------------------------------------------------------

## Slope Efficiency Data ---------------------------------------------------
slope.plate1 <- read.csv("Fluidigm calibration curves liver.csv")
slope.plate2 <- read.csv("Fluidigm calibration curves gill.csv")

View(slope.plate1)
View(slope.plate2)

## HSP70 -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
HSP70.liver <- liver %>%
  filter(EvaGreen.Name %in% c("HSP70", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$hsp70 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(HSP70.liver)

HSP70.liver <- liver %>%
  filter(EvaGreen.Name %in% c("HSP70", "18s"))
        
View(HSP70.liver)

HSP70.liver.averaged <- HSP70.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "2L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "3L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "4L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "5L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "6L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "7L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "8L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "9L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "10L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "11L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "12L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "13L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "14L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "15L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "16L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "17L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "18L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "19L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "20L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "21L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "22L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "23L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "24L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "25L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "26L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "27L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "28L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "29L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "30L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "31L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "32L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "33L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "34L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "35L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "36L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "37L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "38L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "39L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "40L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "41L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "42L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "43L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "44L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "45L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "46L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "47L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "48L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "49L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "50L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "51L" & EvaGreen.Name == "HSP70" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "52L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "53L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "54L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "55L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "56L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "57L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "58L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "59L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "60L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "61L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "62L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "63L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "64L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "65L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "66L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "67L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "68L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "69L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "70L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "71L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "72L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "73L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "74L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "75L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "76L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"],
    Sample.Name == "77L" & EvaGreen.Name == "HSP70"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HSP70"])) 
View(HSP70.liver.averaged)


View(HSP70.liver.averaged)
## Control Average
HSP70.Control <- HSP70.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

HSP70.Control

## Relative Gene Expression 
HSP70.liver.averaged.delta.ct <- HSP70.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "HSP70" ~ HSP70.Control$control.average.ct[HSP70.Control$EvaGreen.Name=="HSP70"],
    EvaGreen.Name == "18s" ~ HSP70.Control$control.average.ct[HSP70.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

HSP70.gene.expression.ratio <- HSP70.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="HSP70"]^delta.ct[EvaGreen.Name=="HSP70"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "HSP70")

View(HSP70.gene.expression.ratio)

HSP70.liver.results <- HSP70.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())
  
  

View(HSP70.liver.results)

HSP70.relative.expression.ratio <- HSP70.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = HSP70.liver.results$average.gene.expression[HSP70.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)
View(HSP70.relative.expression.ratio)

HSP70.liver.relative.results <- HSP70.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
HSP70.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

HSP70.relative.expression.ratio.stats <- HSP70.relative.expression.ratio %>%
  mutate(
      Pool = case_when(
        Sample.Name == "1L" ~ "Starved_Rock",
        Sample.Name == "2L" ~ "Starved_Rock",
        Sample.Name == "3L" ~ "Starved_Rock",
        Sample.Name == "4L" ~ "Starved_Rock",
        Sample.Name == "5L" ~ "Starved_Rock",
        Sample.Name == "6L" ~ "Starved_Rock",
        Sample.Name == "7L" ~ "Starved_Rock",
        Sample.Name == "8L" ~ "Starved_Rock",
        Sample.Name == "9L" ~ "Starved_Rock",
        Sample.Name == "10L" ~ "Starved_Rock",
        Sample.Name == "11L" ~ "La_Grange",
        Sample.Name == "12L" ~ "La_Grange",
        Sample.Name == "13L" ~ "La_Grange",
        Sample.Name == "14L" ~ "La_Grange",
        Sample.Name == "15L" ~ "La_Grange",
        Sample.Name == "16L" ~ "La_Grange",
        Sample.Name == "17L" ~ "La_Grange",
        Sample.Name == "18L" ~ "La_Grange",
        Sample.Name == "19L" ~ "La_Grange",
        Sample.Name == "20L" ~ "La_Grange",
        Sample.Name == "21L" ~ "Dresden_Island",
        Sample.Name == "22L" ~ "Dresden_Island",
        Sample.Name == "23L" ~ "Dresden_Island",
        Sample.Name == "24L" ~ "Dresden_Island",
        Sample.Name == "25L" ~ "Dresden_Island",
        Sample.Name == "26L" ~ "Dresden_Island",
        Sample.Name == "27L" ~ "Dresden_Island",
        Sample.Name == "28L" ~ "Dresden_Island",
        Sample.Name == "29L" ~ "Dresden_Island",
        Sample.Name == "30L" ~ "Dresden_Island",
        Sample.Name == "31L" ~ "Dresden_Island",
        Sample.Name == "32L" ~ "Dresden_Island",
        Sample.Name == "33L" ~ "Starved_Rock",
        Sample.Name == "34L" ~ "Starved_Rock",
        Sample.Name == "35L" ~ "Starved_Rock",
        Sample.Name == "36L" ~ "Starved_Rock",
        Sample.Name == "37L" ~ "Starved_Rock",
        Sample.Name == "38L" ~ "Starved_Rock",
        Sample.Name == "39L" ~ "Starved_Rock",
        Sample.Name == "40L" ~ "Starved_Rock",
        Sample.Name == "41L" ~ "Starved_Rock",
        Sample.Name == "42L" ~ "Starved_Rock",
        Sample.Name == "43L" ~ "La_Grange",
        Sample.Name == "44L" ~ "La_Grange", 
        Sample.Name == "45L" ~ "La_Grange",
        Sample.Name == "46L" ~ "La_Grange",
        Sample.Name == "47L" ~ "La_Grange",
        Sample.Name == "48L" ~ "La_Grange",
        Sample.Name == "49L" ~ "La_Grange",
        Sample.Name == "50L" ~ "La_Grange",
        Sample.Name == "51L" ~ "La_Grange",
        Sample.Name == "52L" ~ "La_Grange",
        Sample.Name == "53L" ~ "La_Grange",
        Sample.Name == "54L" ~ "La_Grange",
        Sample.Name == "55L" ~ "La_Grange",
        Sample.Name == "56L" ~ "La_Grange",
        Sample.Name == "57L" ~ "La_Grange",
        Sample.Name == "58L" ~ "La_Grange",
        Sample.Name == "59L" ~ "La_Grange",
        Sample.Name == "60L" ~ "La_Grange",
        Sample.Name == "61L" ~ "La_Grange",
        Sample.Name == "62L" ~ "La_Grange",
        Sample.Name == "63L" ~ "Starved_Rock",
        Sample.Name == "64L" ~ "Starved_Rock",
        Sample.Name == "65L" ~ "Starved_Rock",
        Sample.Name == "66L" ~ "Starved_Rock",
        Sample.Name == "67L" ~ "Starved_Rock",
        Sample.Name == "68L" ~ "Starved_Rock",
        Sample.Name == "69L" ~ "Starved_Rock",
        Sample.Name == "70L" ~ "Starved_Rock",
        Sample.Name == "71L" ~ "Starved_Rock",
        Sample.Name == "72L" ~ "Starved_Rock",
        Sample.Name == "73L" ~ "Dresden_Island",
        Sample.Name == "74L" ~ "Dresden_Island",
        Sample.Name == "75L" ~ "Dresden_Island",
        Sample.Name == "76L" ~ "Dresden_Island",
        Sample.Name == "77L" ~ "Dresden_Island")) %>%
      mutate(
        Season = case_when(
          Sample.Name == "1L" ~ "Spring",
          Sample.Name == "2L" ~ "Spring",
          Sample.Name == "3L" ~ "Spring",
          Sample.Name == "4L" ~ "Spring",
          Sample.Name == "5L" ~ "Spring",
          Sample.Name == "6L" ~ "Spring",
          Sample.Name == "7L" ~ "Spring",
          Sample.Name == "8L" ~ "Spring",
          Sample.Name == "9L" ~ "Spring",
          Sample.Name == "10L" ~ "Spring",
          Sample.Name == "11L" ~ "Spring",
          Sample.Name == "12L" ~ "Spring",
          Sample.Name == "13L" ~ "Spring",
          Sample.Name == "14L" ~ "Spring",
          Sample.Name == "15L" ~ "Spring",
          Sample.Name == "16L" ~ "Spring",
          Sample.Name == "17L" ~ "Spring",
          Sample.Name == "18L" ~ "Spring",
          Sample.Name == "19L" ~ "Spring",
          Sample.Name == "20L" ~ "Spring",
          Sample.Name == "21L" ~ "Spring",
          Sample.Name == "22L" ~ "Spring",
          Sample.Name == "23L" ~ "Summer",
          Sample.Name == "24L" ~ "Summer",
          Sample.Name == "25L" ~ "Summer",
          Sample.Name == "26L" ~ "Summer",
          Sample.Name == "27L" ~ "Summer",
          Sample.Name == "28L" ~ "Summer",
          Sample.Name == "29L" ~ "Summer",
          Sample.Name == "30L" ~ "Summer",
          Sample.Name == "31L" ~ "Summer",
          Sample.Name == "32L" ~ "Summer",
          Sample.Name == "33L" ~ "Summer",
          Sample.Name == "34L" ~ "Summer",
          Sample.Name == "35L" ~ "Summer",
          Sample.Name == "36L" ~ "Summer",
          Sample.Name == "37L" ~ "Summer",
          Sample.Name == "38L" ~ "Summer",
          Sample.Name == "39L" ~ "Summer",
          Sample.Name == "40L" ~ "Summer",
          Sample.Name == "41L" ~ "Summer",
          Sample.Name == "42L" ~ "Summer",
          Sample.Name == "43L" ~ "Summer",
          Sample.Name == "44L" ~ "Summer", 
          Sample.Name == "45L" ~ "Summer",
          Sample.Name == "46L" ~ "Summer",
          Sample.Name == "47L" ~ "Summer",
          Sample.Name == "48L" ~ "Summer",
          Sample.Name == "49L" ~ "Summer",
          Sample.Name == "50L" ~ "Summer",
          Sample.Name == "51L" ~ "Summer",
          Sample.Name == "52L" ~ "Summer",
          Sample.Name == "53L" ~ "Fall",
          Sample.Name == "54L" ~ "Fall",
          Sample.Name == "55L" ~ "Fall",
          Sample.Name == "56L" ~ "Fall",
          Sample.Name == "57L" ~ "Fall",
          Sample.Name == "58L" ~ "Fall",
          Sample.Name == "59L" ~ "Fall",
          Sample.Name == "60L" ~ "Fall",
          Sample.Name == "61L" ~ "Fall",
          Sample.Name == "62L" ~ "Fall",
          Sample.Name == "63L" ~ "Fall",
          Sample.Name == "64L" ~ "Fall",
          Sample.Name == "65L" ~ "Fall",
          Sample.Name == "66L" ~ "Fall",
          Sample.Name == "67L" ~ "Fall",
          Sample.Name == "68L" ~ "Fall",
          Sample.Name == "69L" ~ "Fall",
          Sample.Name == "70L" ~ "Fall",
          Sample.Name == "71L" ~ "Fall",
          Sample.Name == "72L" ~ "Fall",
          Sample.Name == "73L" ~ "Fall",
          Sample.Name == "74L" ~ "Fall",
          Sample.Name == "75L" ~ "Fall",
          Sample.Name == "76L" ~ "Fall",
          Sample.Name == "77L" ~ "Fall")) 

View(HSP70.relative.expression.ratio.stats)

HSP70.liver.relative.results.stats <- HSP70.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )

HSP70.liver.relative.results.stats

HSP70.relative.expression.ratio.stats.nofall <- HSP70.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(HSP70.relative.expression.ratio.stats.nofall)

HSP70.liver.relative.results.stats.nofall <- HSP70.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )

HSP70.liver.relative.results.stats.nofall
log2(HSP70.liver.relative.results.stats.nofall$average.relative.expression)
# two-way ANOVA

hsp70_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = HSP70.relative.expression.ratio.stats)
summary(hsp70_liver_twoway_anova_results)
Anova(hsp70_liver_twoway_anova_results)
plot(hsp70_liver_twoway_anova_results)

hsp70_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = HSP70.relative.expression.ratio.stats.nofall)
summary(hsp70_liver_twoway_anova_rank)
Anova(hsp70_liver_twoway_anova_rank)
plot(hsp70_liver_twoway_anova_rank)

hsp70_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = HSP70.relative.expression.ratio.r1hrmix)
eta_squared(hsp70_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(hsp70_liver_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(hsp70_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = HSP70.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=HSP70.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=HSP70.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(hsp70_liver_twoway_anova_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(hsp70_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- HSP70.relative.expression.ratio.stats %>%
  group_by(Pool) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))
  

HSP70.liver.boxplot <- ggplot(HSP70.relative.expression.ratio.stats, aes(y=log2(relative.expression), x=Pool)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Pool, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("HSP70 - Liver")

print(HSP70.liver.boxplot)

###report stats------------------------------------

HSP70_liver_stats <- HSP70.relative.expression.ratio.stats.nofall %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(HSP70_liver_stats)

### Gill -------------------------------------------------------------------
HSP70.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("HSP70", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$hsp70 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(HSP70.Gill)

HSP70.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("HSP70", "18s"))
        
View(HSP70.Gill)


HSP70.Gill.averaged <- HSP70.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "2G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "3G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "4G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "5G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "6G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "7G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "8G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "9G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "10G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "11G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "12G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "13G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "14G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "15G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "16G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "17G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "18G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "19G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "20G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "21G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "22G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "23G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "24G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "25G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "26G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "27G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "28G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "29G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "30G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "31G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "32G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "33G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "34G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "35G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "36G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "37G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "38G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "39G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "40G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "41G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "42G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "43G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "44G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "45G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "46G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "47G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "48G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "49G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "50G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "51G" & EvaGreen.Name == "HSP70" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "52G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "53G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "54G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "55G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "56G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "57G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "58G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "59G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "60G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "61G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "62G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "63G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "64G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "65G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "66G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "67G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "68G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "69G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "70G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "71G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "72G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "73G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "74G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "75G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "76G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"],
    Sample.Name == "77G" & EvaGreen.Name == "HSP70"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HSP70"])) 
View(HSP70.Gill.averaged)
## Control Average
HSP70.Control <- HSP70.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

HSP70.Control

## Relative Gene Expression 
HSP70.Gill.averaged.delta.ct <- HSP70.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "HSP70" ~ HSP70.Control$control.average.ct[HSP70.Control$EvaGreen.Name=="HSP70"],
    EvaGreen.Name == "18s" ~ HSP70.Control$control.average.ct[HSP70.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

HSP70.gene.expression.ratio <- HSP70.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="HSP70"]^delta.ct[EvaGreen.Name=="HSP70"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "HSP70")

View(HSP70.gene.expression.ratio)

HSP70.Gill.results <- HSP70.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(HSP70.Gill.results)

HSP70.relative.expression.ratio <- HSP70.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = HSP70.Gill.results$average.gene.expression[HSP70.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

HSP70.Gill.relative.results <- HSP70.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
HSP70.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

HSP70.relative.expression.ratio.stats <- HSP70.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(HSP70.relative.expression.ratio.stats)


# two-way ANOVA

HSP70_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = HSP70.relative.expression.ratio.stats)
summary(HSP70_Gill_twoway_anova_results)
Anova(HSP70_Gill_twoway_anova_results)
plot(HSP70_Gill_twoway_anova_results)

HSP70_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = HSP70.relative.expression.ratio.stats)
summary(HSP70_Gill_twoway_anova_rank)
Anova(HSP70_Gill_twoway_anova_rank)
plot(HSP70_Gill_twoway_anova_rank)

HSP70_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = HSP70.relative.expression.ratio.r1hrmix)
eta_squared(HSP70_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(HSP70_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(HSP70_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = HSP70.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=HSP70.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=HSP70.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(HSP70_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(HSP70_Gill_twoway_anova_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- HSP70.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


HSP70.Gill.boxplot <- ggplot(HSP70.relative.expression.ratio.stats, aes(y=log2(relative.expression), x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("HSP70 - Gill")

print(HSP70.Gill.boxplot)
###report stats------------------------------------

HSP70_gill_stats <- HSP70.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(HSP70_gill_stats)


## p53 -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
P53.liver <- liver %>%
  filter(EvaGreen.Name %in% c("P53", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$p53 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(P53.liver)

P53.liver <- liver %>%
  filter(EvaGreen.Name %in% c("P53", "18s"))
View(P53.liver)

P53.liver.averaged <- P53.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "2L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "3L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "4L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "5L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "6L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "7L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "8L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "9L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "10L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "11L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "12L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "13L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "14L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "15L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "16L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "17L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "18L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "19L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "20L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "21L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "22L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "23L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "24L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "25L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "26L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "27L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "28L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "29L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "30L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "31L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "32L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "33L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "34L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "35L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "36L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "37L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "38L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "39L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "40L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "41L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "42L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "43L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "44L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "45L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "46L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "47L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "48L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "49L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "50L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "51L" & EvaGreen.Name == "P53" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "52L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "53L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "54L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "55L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "56L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "57L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "58L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "59L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "60L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "61L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "62L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "63L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "64L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "65L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "66L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "67L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "68L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "69L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "70L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "71L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "72L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "73L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "74L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "75L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "76L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"],
    Sample.Name == "77L" & EvaGreen.Name == "P53"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="P53"])) 
View(P53.liver.averaged)
## Control Average
P53.Control <- P53.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

P53.Control

## Relative Gene Expression 
P53.liver.averaged.delta.ct <- P53.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "P53" ~ P53.Control$control.average.ct[P53.Control$EvaGreen.Name=="P53"],
    EvaGreen.Name == "18s" ~ P53.Control$control.average.ct[P53.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

P53.gene.expression.ratio <- P53.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="P53"]^delta.ct[EvaGreen.Name=="P53"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "P53")

View(P53.gene.expression.ratio)

P53.liver.results <- P53.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(P53.liver.results)

P53.relative.expression.ratio <- P53.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = P53.liver.results$average.gene.expression[P53.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

P53.liver.relative.results <- P53.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
P53.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

P53.relative.expression.ratio.stats <- P53.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(P53.relative.expression.ratio.stats)

P53.relative.expression.ratio.stats.nofall <- P53.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(P53.relative.expression.ratio.stats.nofall)
# two-way ANOVA

P53_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = P53.relative.expression.ratio.stats)
summary(P53_liver_twoway_anova_results)
Anova(P53_liver_twoway_anova_results)
plot(P53_liver_twoway_anova_results)

P53_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = P53.relative.expression.ratio.stats)
summary(P53_liver_twoway_anova_rank)
Anova(P53_liver_twoway_anova_rank)
plot(P53_liver_twoway_anova_rank)

P53_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = P53.relative.expression.ratio.r1hrmix)
eta_squared(P53_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(P53_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(P53_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = P53.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=P53.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=P53.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(P53_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(P53_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- P53.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


P53.liver.boxplot <- ggplot(P53.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("P53 - Liver")

print(P53.liver.boxplot)

###report stats------------------------------------

P53_liver_stats <- P53.relative.expression.ratio.stats.nofall %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(P53_liver_stats)

### Gill -------------------------------------------------------------------
P53.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("P53", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$p53 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(P53.Gill)

P53.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("P53", "18s"))
        
View(P53.Gill)

P53.Gill.averaged <- P53.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "2G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "3G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "4G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "5G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "6G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "7G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "8G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "9G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "10G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "11G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "12G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "13G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "14G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "15G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "16G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "17G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "18G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "19G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "20G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "21G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "22G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "23G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "24G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "25G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "26G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "27G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "28G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "29G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "30G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "31G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "32G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "33G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "34G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "35G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "36G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "37G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "38G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "39G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "40G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "41G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "42G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "43G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "44G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "45G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "46G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "47G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "48G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "49G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "50G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "51G" & EvaGreen.Name == "P53" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "52G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "53G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "54G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "55G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "56G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "57G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "58G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "59G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "60G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "61G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "62G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "63G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "64G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "65G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "66G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "67G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "68G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "69G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "70G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "71G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "72G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "73G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "74G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "75G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "76G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"],
    Sample.Name == "77G" & EvaGreen.Name == "P53"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="P53"])) 
View(P53.Gill.averaged)
## Control Average
P53.Control <- P53.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

P53.Control

## Relative Gene Expression 
P53.Gill.averaged.delta.ct <- P53.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "P53" ~ P53.Control$control.average.ct[P53.Control$EvaGreen.Name=="P53"],
    EvaGreen.Name == "18s" ~ P53.Control$control.average.ct[P53.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

P53.gene.expression.ratio <- P53.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="P53"]^delta.ct[EvaGreen.Name=="P53"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "P53")

View(P53.gene.expression.ratio)

P53.Gill.results <- P53.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(P53.Gill.results)

P53.relative.expression.ratio <- P53.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = P53.Gill.results$average.gene.expression[P53.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

P53.Gill.relative.results <- P53.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
P53.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

P53.relative.expression.ratio.stats <- P53.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(P53.relative.expression.ratio.stats)


# two-way ANOVA

P53_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = P53.relative.expression.ratio.stats)
summary(P53_Gill_twoway_anova_results)
Anova(P53_Gill_twoway_anova_results)
plot(P53_Gill_twoway_anova_results)

P53_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = P53.relative.expression.ratio.stats)
summary(P53_Gill_twoway_anova_rank)
Anova(P53_Gill_twoway_anova_rank)
plot(P53_Gill_twoway_anova_rank)

P53_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = P53.relative.expression.ratio.r1hrmix)
eta_squared(P53_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(P53_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(P53_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = P53.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=P53.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=P53.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(P53_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(P53_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- P53.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


P53.Gill.boxplot <- ggplot(P53.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("P53 - Gill")

print(P53.Gill.boxplot)

###report stats------------------------------------

P53_gill_stats <- P53.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(P53_gill_stats)

## HIF1A -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
HIF1a.liver <- liver %>%
  filter(EvaGreen.Name %in% c("HIF1-a", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$hif1a %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(HIF1a.liver)

HIF1a.liver <- liver %>%
  filter(EvaGreen.Name %in% c("HIF1-a", "18s"))
         
View(HIF1a.liver)

HIF1a.liver.averaged <- HIF1a.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "2L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "3L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "4L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "5L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "6L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "7L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "8L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "9L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "10L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "11L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "12L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "13L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "14L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "15L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "16L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "17L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "18L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "19L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "20L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "21L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "22L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "23L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "24L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "25L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "26L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "27L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "28L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "29L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "30L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "31L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "32L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "33L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "34L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "35L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "36L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "37L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "38L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "39L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "40L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "41L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "42L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "43L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "44L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "45L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "46L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "47L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "48L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "49L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "50L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "51L" & EvaGreen.Name == "HIF1-a" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "52L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "53L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "54L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "55L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "56L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "57L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "58L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "59L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "60L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "61L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "62L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "63L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "64L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "65L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "66L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "67L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "68L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "69L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "70L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "71L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "72L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "73L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "74L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "75L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "76L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"],
    Sample.Name == "77L" & EvaGreen.Name == "HIF1-a"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="HIF1-a"])) 
View(HIF1a.liver.averaged)
## Control Average
HIF1a.Control <- HIF1a.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

HIF1a.Control

## Relative Gene Expression 
HIF1a.liver.averaged.delta.ct <- HIF1a.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "HIF1-a" ~ HIF1a.Control$control.average.ct[HIF1a.Control$EvaGreen.Name=="HIF1-a"],
    EvaGreen.Name == "18s" ~ HIF1a.Control$control.average.ct[HIF1a.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

HIF1a.gene.expression.ratio <- HIF1a.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="HIF1-a"]^delta.ct[EvaGreen.Name=="HIF1-a"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "HIF1-a")

View(HIF1a.gene.expression.ratio)

HIF1a.liver.results <- HIF1a.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(HIF1a.liver.results)

HIF1a.relative.expression.ratio <- HIF1a.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = HIF1a.liver.results$average.gene.expression[HIF1a.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

HIF1a.liver.relative.results <- HIF1a.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
HIF1a.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

HIF1a.relative.expression.ratio.stats <- HIF1a.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(HIF1a.relative.expression.ratio.stats)

HIF1a.relative.expression.ratio.stats.nofall <- HIF1a.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(HIF1a.relative.expression.ratio.stats.nofall)
# two-way ANOVA

HIF1a_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = HIF1a.relative.expression.ratio.stats)
summary(HIF1a_liver_twoway_anova_results)
Anova(HIF1a_liver_twoway_anova_results)
plot(HIF1a_liver_twoway_anova_results)

HIF1a_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = HIF1a.relative.expression.ratio.stats)
summary(HIF1a_liver_twoway_anova_rank)
Anova(HIF1a_liver_twoway_anova_rank)
plot(HIF1a_liver_twoway_anova_rank)

HIF1a_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = HIF1a.relative.expression.ratio.r1hrmix)
eta_squared(HIF1a_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(HIF1a_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(HIF1a_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = HIF1a.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=HIF1a.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=HIF1a.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(HIF1a_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(HIF1a_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- HIF1a.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


HIF1a.liver.boxplot <- ggplot(HIF1a.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("HIF1-a - Liver")

print(HIF1a.liver.boxplot)

###report stats------------------------------------

HSP70_liver_stats <- HSP70.relative.expression.ratio.stats.nofall %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(HSP70_liver_stats)

### Gill -------------------------------------------------------------------
HIF1a.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("HIF1-a", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$hif1a %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(HIF1a.Gill)

HIF1a.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("HIF1-a", "18s"))
        
View(HIF1a.Gill)

HIF1a.Gill.averaged <- HIF1a.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "2G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "3G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "4G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "5G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "6G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "7G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "8G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "9G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "10G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "11G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "12G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "13G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "14G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "15G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "16G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "17G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "18G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "19G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "20G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "21G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "22G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "23G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "24G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "25G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "26G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "27G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "28G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "29G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "30G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "31G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "32G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "33G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "34G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "35G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "36G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "37G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "38G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "39G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "40G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "41G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "42G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "43G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "44G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "45G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "46G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "47G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "48G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "49G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "50G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "51G" & EvaGreen.Name == "HIF1-a" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "52G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "53G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "54G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "55G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "56G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "57G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "58G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "59G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "60G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "61G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "62G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "63G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "64G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "65G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "66G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "67G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "68G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "69G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "70G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "71G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "72G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "73G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "74G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "75G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "76G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"],
    Sample.Name == "77G" & EvaGreen.Name == "HIF1-a"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="HIF1-a"])) 
View(HIF1a.Gill.averaged)
## Control Average
HIF1a.Control <- HIF1a.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

HIF1a.Control

## Relative Gene Expression 
HIF1a.Gill.averaged.delta.ct <- HIF1a.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "HIF1-a" ~ HIF1a.Control$control.average.ct[HIF1a.Control$EvaGreen.Name=="HIF1-a"],
    EvaGreen.Name == "18s" ~ HIF1a.Control$control.average.ct[HIF1a.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

HIF1a.gene.expression.ratio <- HIF1a.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="HIF1-a"]^delta.ct[EvaGreen.Name=="HIF1-a"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "HIF1-a")

View(HIF1a.gene.expression.ratio)

HIF1a.Gill.results <- HIF1a.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(HIF1a.Gill.results)

HIF1a.relative.expression.ratio <- HIF1a.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = HIF1a.Gill.results$average.gene.expression[HIF1a.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

HIF1a.Gill.relative.results <- HIF1a.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
HIF1a.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

HIF1a.relative.expression.ratio.stats <- HIF1a.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(HIF1a.relative.expression.ratio.stats)


# two-way ANOVA

HIF1a_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = HIF1a.relative.expression.ratio.stats)
summary(HIF1a_Gill_twoway_anova_results)
Anova(HIF1a_Gill_twoway_anova_results)
plot(HIF1a_Gill_twoway_anova_results)

HIF1a_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = HIF1a.relative.expression.ratio.stats)
summary(HIF1a_Gill_twoway_anova_rank)
Anova(HIF1a_Gill_twoway_anova_rank)
plot(HIF1a_Gill_twoway_anova_rank)

HIF1a_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = HIF1a.relative.expression.ratio.r1hrmix)
eta_squared(HIF1a_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(HIF1a_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(HIF1a_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = HIF1a.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=HIF1a.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=HIF1a.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(HIF1a_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(HIF1a_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- HIF1a.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


HIF1a.Gill.boxplot <- ggplot(HIF1a.relative.expression.ratio.stats, aes(y=log2(relative.expression), x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("HIF1-a - Gill")

print(HIF1a.Gill.boxplot)


###report stats------------------------------------

HIF1a_gill_stats <- HIF1a.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(HIF1a_gill_stats)

## SOD1 -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
SOD1.liver <- liver %>%
  filter(EvaGreen.Name %in% c("SOD1", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$sod1 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(SOD1.liver)

SOD1.liver <- liver %>%
  filter(EvaGreen.Name %in% c("SOD1", "18s"))
        
View(SOD1.liver)

SOD1.liver.averaged <- SOD1.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "2L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "3L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "4L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "5L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "6L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "7L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "8L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "9L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "10L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "11L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "12L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "13L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "14L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "15L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "16L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "17L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "18L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "19L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "20L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "21L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "22L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "23L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "24L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "25L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "26L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "27L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "28L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "29L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "30L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "31L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "32L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "33L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "34L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "35L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "36L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "37L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "38L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "39L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "40L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "41L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "42L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "43L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "44L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "45L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "46L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "47L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "48L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "49L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "50L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "51L" & EvaGreen.Name == "SOD1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "52L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "53L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "54L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "55L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "56L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "57L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "58L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "59L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "60L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "61L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "62L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "63L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "64L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "65L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "66L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "67L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "68L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "69L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "70L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "71L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "72L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "73L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "74L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "75L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "76L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"],
    Sample.Name == "77L" & EvaGreen.Name == "SOD1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="SOD1"])) 
View(SOD1.liver.averaged)
## Control Average
SOD1.Control <- SOD1.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

SOD1.Control

## Relative Gene Expression 
SOD1.liver.averaged.delta.ct <- SOD1.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "SOD1" ~ SOD1.Control$control.average.ct[SOD1.Control$EvaGreen.Name=="SOD1"],
    EvaGreen.Name == "18s" ~ SOD1.Control$control.average.ct[SOD1.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

SOD1.gene.expression.ratio <- SOD1.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="SOD1"]^delta.ct[EvaGreen.Name=="SOD1"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "SOD1")

View(SOD1.gene.expression.ratio)

SOD1.liver.results <- SOD1.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(SOD1.liver.results)

SOD1.relative.expression.ratio <- SOD1.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = SOD1.liver.results$average.gene.expression[SOD1.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

SOD1.liver.relative.results <- SOD1.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
SOD1.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

SOD1.relative.expression.ratio.stats <- SOD1.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(SOD1.relative.expression.ratio.stats)

SOD1.relative.expression.ratio.stats.nofall <- SOD1.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(SOD1.relative.expression.ratio.stats.nofall)
# two-way ANOVA

SOD1_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = SOD1.relative.expression.ratio.stats)
summary(SOD1_liver_twoway_anova_results)
Anova(SOD1_liver_twoway_anova_results)
plot(SOD1_liver_twoway_anova_results)

SOD1_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = SOD1.relative.expression.ratio.stats)
summary(SOD1_liver_twoway_anova_rank)
Anova(SOD1_liver_twoway_anova_rank)
plot(SOD1_liver_twoway_anova_rank)

SOD1_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = SOD1.relative.expression.ratio.r1hrmix)
eta_squared(SOD1_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(SOD1_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(SOD1_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = SOD1.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=SOD1.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=SOD1.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(SOD1_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(SOD1_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- SOD1.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


SOD1.liver.boxplot <- ggplot(SOD1.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("SOD1 - Liver")

print(SOD1.liver.boxplot)

###report stats------------------------------------

SOD1_liver_stats <- SOD1.relative.expression.ratio.stats.nofall %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(SOD1_liver_stats)

### Gill -------------------------------------------------------------------
SOD1.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("SOD1", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$sod1 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(SOD1.Gill)

SOD1.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("SOD1", "18s"))
        
View(SOD1.Gill)

SOD1.Gill.averaged <- SOD1.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "2G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "3G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "4G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "5G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "6G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "7G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "8G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "9G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "10G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "11G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "12G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "13G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "14G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "15G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "16G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "17G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "18G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "19G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "20G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "21G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "22G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "23G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "24G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "25G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "26G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "27G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "28G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "29G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "30G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "31G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "32G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "33G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "34G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "35G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "36G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "37G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "38G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "39G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "40G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "41G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "42G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "43G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "44G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "45G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "46G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "47G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "48G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "49G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "50G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "51G" & EvaGreen.Name == "SOD1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "52G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "53G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "54G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "55G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "56G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "57G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "58G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "59G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "60G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "61G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "62G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "63G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "64G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "65G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "66G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "67G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "68G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "69G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "70G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "71G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "72G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "73G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "74G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "75G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "76G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"],
    Sample.Name == "77G" & EvaGreen.Name == "SOD1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="SOD1"])) 
View(SOD1.Gill.averaged)
## Control Average
SOD1.Control <- SOD1.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

SOD1.Control

## Relative Gene Expression 
SOD1.Gill.averaged.delta.ct <- SOD1.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "SOD1" ~ SOD1.Control$control.average.ct[SOD1.Control$EvaGreen.Name=="SOD1"],
    EvaGreen.Name == "18s" ~ SOD1.Control$control.average.ct[SOD1.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

SOD1.gene.expression.ratio <- SOD1.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="SOD1"]^delta.ct[EvaGreen.Name=="SOD1"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "SOD1")

View(SOD1.gene.expression.ratio)

SOD1.Gill.results <- SOD1.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(SOD1.Gill.results)

SOD1.relative.expression.ratio <- SOD1.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = SOD1.Gill.results$average.gene.expression[SOD1.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

SOD1.Gill.relative.results <- SOD1.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
SOD1.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

SOD1.relative.expression.ratio.stats <- SOD1.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(SOD1.relative.expression.ratio.stats)


# two-way ANOVA

SOD1_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = SOD1.relative.expression.ratio.stats)
summary(SOD1_Gill_twoway_anova_results)
Anova(SOD1_Gill_twoway_anova_results)
plot(SOD1_Gill_twoway_anova_results)

SOD1_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = SOD1.relative.expression.ratio.stats)
summary(SOD1_Gill_twoway_anova_rank)
Anova(SOD1_Gill_twoway_anova_rank)
plot(SOD1_Gill_twoway_anova_rank)

SOD1_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = SOD1.relative.expression.ratio.r1hrmix)
eta_squared(SOD1_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(SOD1_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(SOD1_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = SOD1.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=SOD1.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=SOD1.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(SOD1_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(SOD1_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- SOD1.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


SOD1.Gill.boxplot <- ggplot(SOD1.relative.expression.ratio.stats, aes(y=log2(relative.expression), x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("SOD1 - Gill")

print(SOD1.Gill.boxplot)

###report stats------------------------------------

SOD1_gill_stats <- SOD1.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(SOD1_gill_stats)

## GHR -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
GHR.liver <- liver %>%
  filter(EvaGreen.Name %in% c("GHR", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$ghr %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(GHR.liver)

GHR.liver <- liver %>%
  filter(EvaGreen.Name %in% c("GHR", "18s"))
        
View(GHR.liver)

GHR.liver.averaged.summer <- GHR.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "2L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "3L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "4L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "5L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "6L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "7L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "8L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "9L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "10L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "11L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "12L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "13L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "14L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "15L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "16L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "17L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "18L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "19L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "20L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "21L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "22L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "23L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "24L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "25L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "26L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "27L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "28L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "29L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "30L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "31L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "32L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "33L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "34L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "35L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "36L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "37L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "38L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "39L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "40L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "41L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "42L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "43L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "44L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "45L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "46L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "47L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "48L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "49L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "50L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "51L" & EvaGreen.Name == "GHR" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "52L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "53L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "54L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "55L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "56L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "57L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "58L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "59L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "60L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "61L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "62L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "63L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "64L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "65L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "66L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "67L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "68L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "69L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "70L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "71L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "72L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "73L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "74L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "75L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "76L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"],
    Sample.Name == "77L" & EvaGreen.Name == "GHR"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GHR"])) 
View(GHR.liver.averaged.summer)

##remove spring and fall
GHR.liver.averaged <- GHR.liver.averaged.summer %>%
 filter(Season != "Spring") 
View(GHR.liver.averaged)
## Control Average
GHR.Control <- GHR.liver.averaged %>%
  filter(Treatment == "La_Grange_Summer") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

GHR.Control

## Relative Gene Expression 
GHR.liver.averaged.delta.ct <- GHR.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "GHR" ~ GHR.Control$control.average.ct[GHR.Control$EvaGreen.Name=="GHR"],
    EvaGreen.Name == "18s" ~ GHR.Control$control.average.ct[GHR.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

GHR.gene.expression.ratio <- GHR.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="GHR"]^delta.ct[EvaGreen.Name=="GHR"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "GHR")

View(GHR.gene.expression.ratio)

GHR.liver.results <- GHR.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(GHR.liver.results)

GHR.relative.expression.ratio <- GHR.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = GHR.liver.results$average.gene.expression[GHR.liver.results$Treatment=="La_Grange_Summer"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

GHR.liver.relative.results <- GHR.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
GHR.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

GHR.relative.expression.ratio.stats <- GHR.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(GHR.relative.expression.ratio.stats)

# two-way ANOVA

GHR_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = GHR.relative.expression.ratio.stats)
summary(GHR_liver_twoway_anova_results)
Anova(GHR_liver_twoway_anova_results)
plot(GHR_liver_twoway_anova_results)

GHR_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = GHR.relative.expression.ratio.stats)
summary(GHR_liver_twoway_anova_rank)
Anova(GHR_liver_twoway_anova_rank)
plot(GHR_liver_twoway_anova_rank)

GHR_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = GHR.relative.expression.ratio.r1hrmix)
eta_squared(GHR_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(GHR_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(GHR_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = GHR.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=GHR.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=GHR.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(GHR_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(GHR_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- GHR.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


GHR.liver.boxplot <- ggplot(GHR.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("GHR - Liver")

print(GHR.liver.boxplot)

###report stats------------------------------------

HSP70_liver_stats <- HSP70.relative.expression.ratio.stats.nofall %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(HSP70_liver_stats)

### Gill -------------------------------------------------------------------
GHR.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("GHR", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$ghr %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(GHR.Gill)

GHR.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("GHR", "18s"))
        
View(GHR.Gill)

GHR.Gill.averaged <- GHR.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "2G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "3G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "4G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "5G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "6G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "7G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "8G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "9G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "10G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "11G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "12G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "13G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "14G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "15G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "16G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "17G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "18G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "19G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "20G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "21G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "22G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "23G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "24G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "25G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "26G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "27G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "28G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "29G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "30G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "31G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "32G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "33G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "34G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "35G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "36G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "37G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "38G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "39G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "40G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "41G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "42G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "43G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "44G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "45G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "46G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "47G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "48G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "49G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "50G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "51G" & EvaGreen.Name == "GHR" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "52G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "53G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "54G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "55G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "56G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "57G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "58G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "59G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "60G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "61G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "62G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "63G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "64G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "65G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "66G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "67G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "68G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "69G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "70G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "71G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "72G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "73G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "74G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "75G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "76G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"],
    Sample.Name == "77G" & EvaGreen.Name == "GHR"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GHR"])) 
View(GHR.Gill.averaged)
## Control Average
GHR.Control <- GHR.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

GHR.Control

## Relative Gene Expression 
GHR.Gill.averaged.delta.ct <- GHR.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "GHR" ~ GHR.Control$control.average.ct[GHR.Control$EvaGreen.Name=="GHR"],
    EvaGreen.Name == "18s" ~ GHR.Control$control.average.ct[GHR.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

GHR.gene.expression.ratio <- GHR.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="GHR"]^delta.ct[EvaGreen.Name=="GHR"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "GHR")

View(GHR.gene.expression.ratio)

GHR.Gill.results <- GHR.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(GHR.Gill.results)

GHR.relative.expression.ratio <- GHR.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = GHR.Gill.results$average.gene.expression[GHR.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

GHR.Gill.relative.results <- GHR.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
GHR.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

GHR.relative.expression.ratio.stats <- GHR.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(GHR.relative.expression.ratio.stats)


# two-way ANOVA

GHR_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = GHR.relative.expression.ratio.stats)
summary(GHR_Gill_twoway_anova_results)
Anova(GHR_Gill_twoway_anova_results)
plot(GHR_Gill_twoway_anova_results)

GHR_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = GHR.relative.expression.ratio.stats)
summary(GHR_Gill_twoway_anova_rank)
Anova(GHR_Gill_twoway_anova_rank)
plot(GHR_Gill_twoway_anova_rank)

GHR_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = GHR.relative.expression.ratio.r1hrmix)
eta_squared(GHR_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(GHR_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(GHR_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = GHR.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=GHR.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=GHR.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(GHR_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(GHR_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- GHR.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


GHR.Gill.boxplot <- ggplot(GHR.relative.expression.ratio.stats, aes(y=log2(relative.expression), x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("GHR - Gill")

print(GHR.Gill.boxplot)

###report stats------------------------------------

GHR_gill_stats <- GHR.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(GHR_gill_stats)

## CK -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
CK.liver <- liver %>%
  filter(EvaGreen.Name %in% c("CK", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$ck %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CK.liver)

CK.liver <- liver %>%
  filter(EvaGreen.Name %in% c("CK", "18s"))
View(CK.liver)

CK.liver.averaged <- CK.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "2L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "3L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "4L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "5L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "6L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "7L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "8L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "9L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "10L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "11L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "12L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "13L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "14L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "15L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "16L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "17L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "18L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "19L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "20L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "21L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "22L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "23L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "24L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "25L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "26L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "27L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "28L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "29L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "30L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "31L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "32L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "33L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "34L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "35L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "36L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "37L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "38L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "39L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "40L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "41L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "42L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "43L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "44L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "45L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "46L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "47L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "48L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "49L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "50L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "51L" & EvaGreen.Name == "CK" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "52L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "53L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "54L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "55L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "56L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "57L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "58L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "59L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "60L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "61L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "62L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "63L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "64L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "65L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "66L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "67L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "68L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "69L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "70L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "71L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "72L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "73L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "74L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "75L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "76L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"],
    Sample.Name == "77L" & EvaGreen.Name == "CK"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CK"])) 
View(CK.liver.averaged)
## Control Average
CK.Control <- CK.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CK.Control

## Relative Gene Expression 
CK.liver.averaged.delta.ct <- CK.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "CK" ~ CK.Control$control.average.ct[CK.Control$EvaGreen.Name=="CK"],
    EvaGreen.Name == "18s" ~ CK.Control$control.average.ct[CK.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CK.gene.expression.ratio <- CK.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="CK"]^delta.ct[EvaGreen.Name=="CK"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "CK")

View(CK.gene.expression.ratio)

CK.liver.results <- CK.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CK.liver.results)

CK.relative.expression.ratio <- CK.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CK.liver.results$average.gene.expression[CK.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CK.liver.relative.results <- CK.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CK.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CK.relative.expression.ratio.stats <- CK.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(CK.relative.expression.ratio.stats)

CK.relative.expression.ratio.stats.nofall <- CK.relative.expression.ratio.stats %>%
  filter(Season != "Fall")


View(CK.relative.expression.ratio.stats.nofall)

CK.liver.relative.results.stats.nofall <- CK.relative.expression.ratio.stats.nofall %>%
  group_by(Pool, Season) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )

View(CK.liver.relative.results.stats.nofall)
# two-way ANOVA

CK_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CK.relative.expression.ratio.stats)
summary(CK_liver_twoway_anova_results)
Anova(CK_liver_twoway_anova_results)
plot(CK_liver_twoway_anova_results)

CK_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CK.relative.expression.ratio.stats)
summary(CK_liver_twoway_anova_rank)
Anova(CK_liver_twoway_anova_rank)
plot(CK_liver_twoway_anova_rank)

CK_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CK.relative.expression.ratio.r1hrmix)
eta_squared(CK_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CK_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CK_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CK.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CK.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CK.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CK_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CK_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CK.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CK.liver.boxplot <- ggplot(CK.relative.expression.ratio.stats.nofall, aes(y=log2(relative.expression), x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("CK - Liver")

print(CK.liver.boxplot)

### Gill -------------------------------------------------------------------
CK.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("CK", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$ck %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CK.Gill)

CK.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("CK", "18s"))
         
View(CK.Gill)

CK.Gill.averaged <- CK.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "2G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "3G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "4G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "5G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "6G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "7G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "8G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "9G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "10G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "11G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "12G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "13G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "14G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "15G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "16G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "17G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "18G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "19G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "20G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "21G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "22G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "23G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "24G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "25G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "26G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "27G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "28G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "29G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "30G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "31G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "32G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "33G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "34G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "35G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "36G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "37G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "38G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "39G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "40G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "41G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "42G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "43G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "44G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "45G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "46G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "47G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "48G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "49G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "50G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "51G" & EvaGreen.Name == "CK" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "52G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "53G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "54G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "55G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "56G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "57G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "58G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "59G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "60G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "61G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "62G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "63G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "64G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "65G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "66G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "67G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "68G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "69G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "70G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "71G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "72G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "73G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "74G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "75G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "76G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"],
    Sample.Name == "77G" & EvaGreen.Name == "CK"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CK"])) 
View(CK.Gill.averaged)
## Control Average
CK.Control <- CK.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CK.Control

## Relative Gene Expression 
CK.Gill.averaged.delta.ct <- CK.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "CK" ~ CK.Control$control.average.ct[CK.Control$EvaGreen.Name=="CK"],
    EvaGreen.Name == "18s" ~ CK.Control$control.average.ct[CK.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CK.gene.expression.ratio <- CK.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="CK"]^delta.ct[EvaGreen.Name=="CK"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "CK")

View(CK.gene.expression.ratio)

CK.Gill.results <- CK.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CK.Gill.results)

CK.relative.expression.ratio <- CK.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CK.Gill.results$average.gene.expression[CK.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CK.Gill.relative.results <- CK.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CK.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CK.relative.expression.ratio.stats <- CK.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(CK.relative.expression.ratio.stats)


# two-way ANOVA

CK_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CK.relative.expression.ratio.stats)
summary(CK_Gill_twoway_anova_results)
Anova(CK_Gill_twoway_anova_results)
plot(CK_Gill_twoway_anova_results)

CK_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CK.relative.expression.ratio.stats)
summary(CK_Gill_twoway_anova_rank)
Anova(CK_Gill_twoway_anova_rank)
plot(CK_Gill_twoway_anova_rank)

CK_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CK.relative.expression.ratio.r1hrmix)
eta_squared(CK_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CK_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CK_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CK.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CK.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CK.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CK_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CK_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CK.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CK.Gill.boxplot <- ggplot(CK.relative.expression.ratio.stats, aes(y=log2(relative.expression), x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("CK - Gill")

print(CK.Gill.boxplot)

###report stats------------------------------------

CK_gill_stats <- CK.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(CK_gill_stats)

## PHD3 -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
PHD3.liver <- liver %>%
  filter(EvaGreen.Name %in% c("PHD3", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$phd %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(PHD3.liver)

PHD3.liver <- liver %>%
  filter(EvaGreen.Name %in% c("PHD3", "18s"))
         
View(PHD3.liver)

PHD3.liver.averaged <- PHD3.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "2L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "3L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "4L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "5L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "6L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "7L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "8L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "9L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "10L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "11L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "12L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "13L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "14L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "15L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "16L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "17L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "18L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "19L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "20L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "21L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "22L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "23L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "24L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "25L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "26L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "27L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "28L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "29L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "30L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "31L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "32L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "33L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "34L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "35L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "36L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "37L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "38L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "39L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "40L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "41L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "42L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "43L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "44L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "45L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "46L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "47L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "48L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "49L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "50L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "51L" & EvaGreen.Name == "PHD3" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "52L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "53L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "54L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "55L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "56L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "57L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "58L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "59L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "60L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "61L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "62L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "63L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "64L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "65L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "66L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "67L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "68L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "69L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "70L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "71L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "72L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "73L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "74L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "75L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "76L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"],
    Sample.Name == "77L" & EvaGreen.Name == "PHD3"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="PHD3"])) 
View(PHD3.liver.averaged)
## Control Average
PHD3.Control <- PHD3.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

PHD3.Control

## Relative Gene Expression 
PHD3.liver.averaged.delta.ct <- PHD3.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "PHD3" ~ PHD3.Control$control.average.ct[PHD3.Control$EvaGreen.Name=="PHD3"],
    EvaGreen.Name == "18s" ~ PHD3.Control$control.average.ct[PHD3.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

PHD3.gene.expression.ratio <- PHD3.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="PHD3"]^delta.ct[EvaGreen.Name=="PHD3"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "PHD3")

View(PHD3.gene.expression.ratio)

PHD3.liver.results <- PHD3.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(PHD3.liver.results)

PHD3.relative.expression.ratio <- PHD3.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = PHD3.liver.results$average.gene.expression[PHD3.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

PHD3.liver.relative.results <- PHD3.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
PHD3.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

PHD3.relative.expression.ratio.stats <- PHD3.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(PHD3.relative.expression.ratio.stats)

PHD3.relative.expression.ratio.stats.nofall <- PHD3.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(PHD3.relative.expression.ratio.stats.nofall)
# two-way ANOVA

PHD3_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = PHD3.relative.expression.ratio.stats)
summary(PHD3_liver_twoway_anova_results)
Anova(PHD3_liver_twoway_anova_results)
plot(PHD3_liver_twoway_anova_results)

PHD3_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = PHD3.relative.expression.ratio.stats)
summary(PHD3_liver_twoway_anova_rank)
Anova(PHD3_liver_twoway_anova_rank)
plot(PHD3_liver_twoway_anova_rank)

PHD3_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = PHD3.relative.expression.ratio.r1hrmix)
eta_squared(PHD3_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(PHD3_liver_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(PHD3_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = PHD3.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=PHD3.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=PHD3.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(PHD3_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(PHD3_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- PHD3.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


PHD3.liver.boxplot <- ggplot(PHD3.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("PHD3 - Liver")

print(PHD3.liver.boxplot)

###report stats------------------------------------

PHD3_liver_stats <- PHD3.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(PHD3_liver_stats)

### Gill -------------------------------------------------------------------
PHD3.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("PHD3", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$phd %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(PHD3.Gill)

PHD3.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("PHD3", "18s"))
       
View(PHD3.Gill)

PHD3.Gill.averaged <- PHD3.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "2G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "3G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "4G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "5G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "6G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "7G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "8G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "9G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "10G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "11G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "12G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "13G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "14G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "15G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "16G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "17G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "18G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "19G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "20G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "21G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "22G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "23G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "24G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "25G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "26G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "27G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "28G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "29G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "30G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "31G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "32G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "33G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "34G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "35G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "36G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "37G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "38G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "39G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "40G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "41G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "42G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "43G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "44G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "45G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "46G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "47G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "48G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "49G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "50G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "51G" & EvaGreen.Name == "PHD3" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "52G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "53G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "54G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "55G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "56G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "57G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "58G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "59G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "60G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "61G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "62G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "63G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "64G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "65G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "66G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "67G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "68G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "69G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "70G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "71G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "72G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "73G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "74G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "75G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "76G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"],
    Sample.Name == "77G" & EvaGreen.Name == "PHD3"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="PHD3"])) 
View(PHD3.Gill.averaged)
## Control Average
PHD3.Control <- PHD3.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

PHD3.Control

## Relative Gene Expression 
PHD3.Gill.averaged.delta.ct <- PHD3.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "PHD3" ~ PHD3.Control$control.average.ct[PHD3.Control$EvaGreen.Name=="PHD3"],
    EvaGreen.Name == "18s" ~ PHD3.Control$control.average.ct[PHD3.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

PHD3.gene.expression.ratio <- PHD3.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="PHD3"]^delta.ct[EvaGreen.Name=="PHD3"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "PHD3")

View(PHD3.gene.expression.ratio)

PHD3.Gill.results <- PHD3.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(PHD3.Gill.results)

PHD3.relative.expression.ratio <- PHD3.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = PHD3.Gill.results$average.gene.expression[PHD3.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

PHD3.Gill.relative.results <- PHD3.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
PHD3.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

PHD3.relative.expression.ratio.stats <- PHD3.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(PHD3.relative.expression.ratio.stats)


# two-way ANOVA

PHD3_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = PHD3.relative.expression.ratio.stats)
summary(PHD3_Gill_twoway_anova_results)
Anova(PHD3_Gill_twoway_anova_results)
plot(PHD3_Gill_twoway_anova_results)

PHD3_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = PHD3.relative.expression.ratio.stats)
summary(PHD3_Gill_twoway_anova_rank)
Anova(PHD3_Gill_twoway_anova_rank)
plot(PHD3_Gill_twoway_anova_rank)

PHD3_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = PHD3.relative.expression.ratio.r1hrmix)
eta_squared(PHD3_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(PHD3_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(PHD3_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = PHD3.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=PHD3.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=PHD3.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(PHD3_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(PHD3_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- PHD3.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


PHD3.Gill.boxplot <- ggplot(PHD3.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("PHD3 - Gill")

print(PHD3.Gill.boxplot)

###report stats------------------------------------

PHD3_gill_stats <- PHD3.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(PHD3_gill_stats)

## FOX01 -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
FOX01.liver <- liver %>%
  filter(EvaGreen.Name %in% c("FOX01", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$fox %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(FOX01.liver)

FOX01.liver <- liver %>%
  filter(EvaGreen.Name %in% c("FOX01", "18s"))
         
View(FOX01.liver)

FOX01.liver.averaged <- FOX01.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "2L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "3L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "4L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "5L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "6L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "7L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "8L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "9L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "10L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "11L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "12L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "13L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "14L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "15L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "16L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "17L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "18L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "19L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "20L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "21L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "22L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "23L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "24L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "25L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "26L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "27L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "28L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "29L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "30L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "31L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "32L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "33L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "34L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "35L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "36L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "37L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "38L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "39L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "40L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "41L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "42L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "43L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "44L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "45L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "46L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "47L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "48L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "49L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "50L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "51L" & EvaGreen.Name == "FOX01" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "52L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "53L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "54L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "55L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "56L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "57L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "58L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "59L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "60L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "61L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "62L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "63L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "64L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "65L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "66L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "67L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "68L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "69L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "70L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "71L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "72L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "73L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "74L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "75L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "76L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"],
    Sample.Name == "77L" & EvaGreen.Name == "FOX01"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="FOX01"])) 
View(FOX01.liver.averaged)
## Control Average
FOX01.Control <- FOX01.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

FOX01.Control

## Relative Gene Expression 
FOX01.liver.averaged.delta.ct <- FOX01.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "FOX01" ~ FOX01.Control$control.average.ct[FOX01.Control$EvaGreen.Name=="FOX01"],
    EvaGreen.Name == "18s" ~ FOX01.Control$control.average.ct[FOX01.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

FOX01.gene.expression.ratio <- FOX01.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="FOX01"]^delta.ct[EvaGreen.Name=="FOX01"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "FOX01")

View(FOX01.gene.expression.ratio)

FOX01.liver.results <- FOX01.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(FOX01.liver.results)

FOX01.relative.expression.ratio <- FOX01.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = FOX01.liver.results$average.gene.expression[FOX01.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

FOX01.liver.relative.results <- FOX01.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
FOX01.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

FOX01.relative.expression.ratio.stats <- FOX01.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(FOX01.relative.expression.ratio.stats)

FOX01.relative.expression.ratio.stats.nofall <- FOX01.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(FOX01.relative.expression.ratio.stats.nofall)
# two-way ANOVA

FOX01_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = FOX01.relative.expression.ratio.stats)
summary(FOX01_liver_twoway_anova_results)
Anova(FOX01_liver_twoway_anova_results)
plot(FOX01_liver_twoway_anova_results)

FOX01_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = FOX01.relative.expression.ratio.stats)
summary(FOX01_liver_twoway_anova_rank)
Anova(FOX01_liver_twoway_anova_rank)
plot(FOX01_liver_twoway_anova_rank)

FOX01_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = FOX01.relative.expression.ratio.r1hrmix)
eta_squared(FOX01_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(FOX01_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(FOX01_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = FOX01.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=FOX01.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=FOX01.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(FOX01_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(FOX01_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- FOX01.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


FOX01.liver.boxplot <- ggplot(FOX01.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("FOX01 - Liver")

print(FOX01.liver.boxplot)

###report stats------------------------------------

FOX01_liver_stats <- FOX01.relative.expression.ratio.stats.nofall %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(FOX01_liver_stats)

### Gill -------------------------------------------------------------------
FOX01.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("FOX01", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$fox %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(FOX01.Gill)

FOX01.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("FOX01", "18s"))
        
View(FOX01.Gill)

FOX01.Gill.averaged <- FOX01.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "2G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "3G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "4G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "5G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "6G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "7G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "8G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "9G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "10G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "11G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "12G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "13G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "14G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "15G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "16G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "17G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "18G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "19G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "20G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "21G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "22G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "23G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "24G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "25G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "26G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "27G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "28G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "29G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "30G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "31G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "32G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "33G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "34G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "35G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "36G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "37G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "38G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "39G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "40G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "41G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "42G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "43G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "44G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "45G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "46G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "47G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "48G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "49G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "50G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "51G" & EvaGreen.Name == "FOX01" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "52G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "53G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "54G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "55G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "56G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "57G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "58G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "59G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "60G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "61G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "62G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "63G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "64G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "65G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "66G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "67G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "68G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "69G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "70G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "71G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "72G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "73G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "74G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "75G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "76G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"],
    Sample.Name == "77G" & EvaGreen.Name == "FOX01"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="FOX01"])) 
View(FOX01.Gill.averaged)
## Control Average
FOX01.Control <- FOX01.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

FOX01.Control

## Relative Gene Expression 
FOX01.Gill.averaged.delta.ct <- FOX01.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "FOX01" ~ FOX01.Control$control.average.ct[FOX01.Control$EvaGreen.Name=="FOX01"],
    EvaGreen.Name == "18s" ~ FOX01.Control$control.average.ct[FOX01.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

FOX01.gene.expression.ratio <- FOX01.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="FOX01"]^delta.ct[EvaGreen.Name=="FOX01"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "FOX01")

View(FOX01.gene.expression.ratio)

FOX01.Gill.results <- FOX01.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(FOX01.Gill.results)

FOX01.relative.expression.ratio <- FOX01.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = FOX01.Gill.results$average.gene.expression[FOX01.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

FOX01.Gill.relative.results <- FOX01.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
FOX01.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

FOX01.relative.expression.ratio.stats <- FOX01.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(FOX01.relative.expression.ratio.stats)


# two-way ANOVA

FOX01_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = FOX01.relative.expression.ratio.stats)
summary(FOX01_Gill_twoway_anova_results)
Anova(FOX01_Gill_twoway_anova_results)
plot(FOX01_Gill_twoway_anova_results)

FOX01_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = FOX01.relative.expression.ratio.stats)
summary(FOX01_Gill_twoway_anova_rank)
Anova(FOX01_Gill_twoway_anova_rank)
plot(FOX01_Gill_twoway_anova_rank)

FOX01_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = FOX01.relative.expression.ratio.r1hrmix)
eta_squared(FOX01_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(FOX01_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(FOX01_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = FOX01.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=FOX01.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=FOX01.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(FOX01_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(FOX01_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- FOX01.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


FOX01.Gill.boxplot <- ggplot(FOX01.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("FOX01 - Gill")

print(FOX01.Gill.boxplot)

###report stats------------------------------------

FOX01_gill_stats <- FOX01.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(FOX01_gill_stats)

## CTRP1 -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
CTRP1.liver <- liver %>%
  filter(EvaGreen.Name %in% c("CTRP1", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$ctrp %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CTRP1.liver)

CTRP1.liver <- liver %>%
  filter(EvaGreen.Name %in% c("CTRP1", "18s"))
         
View(CTRP1.liver)

CTRP1.liver.averaged <- CTRP1.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "2L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "3L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "4L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "5L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "6L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "7L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "8L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "9L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "10L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "11L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "12L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "13L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "14L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "15L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "16L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "17L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "18L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "19L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "20L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "21L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "22L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "23L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "24L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "25L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "26L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "27L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "28L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "29L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "30L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "31L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "32L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "33L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "34L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "35L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "36L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "37L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "38L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "39L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "40L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "41L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "42L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "43L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "44L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "45L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "46L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "47L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "48L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "49L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "50L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "51L" & EvaGreen.Name == "CTRP1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "52L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "53L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "54L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "55L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "56L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "57L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "58L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "59L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "60L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "61L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "62L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "63L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "64L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "65L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "66L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "67L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "68L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "69L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "70L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "71L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "72L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "73L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "74L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "75L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "76L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"],
    Sample.Name == "77L" & EvaGreen.Name == "CTRP1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CTRP1"])) 
View(CTRP1.liver.averaged)
## Control Average
CTRP1.Control <- CTRP1.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CTRP1.Control

## Relative Gene Expression 
CTRP1.liver.averaged.delta.ct <- CTRP1.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "CTRP1" ~ CTRP1.Control$control.average.ct[CTRP1.Control$EvaGreen.Name=="CTRP1"],
    EvaGreen.Name == "18s" ~ CTRP1.Control$control.average.ct[CTRP1.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CTRP1.gene.expression.ratio <- CTRP1.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="CTRP1"]^delta.ct[EvaGreen.Name=="CTRP1"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "CTRP1")

View(CTRP1.gene.expression.ratio)

CTRP1.liver.results <- CTRP1.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CTRP1.liver.results)

CTRP1.relative.expression.ratio <- CTRP1.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CTRP1.liver.results$average.gene.expression[CTRP1.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CTRP1.liver.relative.results <- CTRP1.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CTRP1.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CTRP1.relative.expression.ratio.stats <- CTRP1.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(CTRP1.relative.expression.ratio.stats)

CTRP1.relative.expression.ratio.stats.nofall <- CTRP1.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(CTRP1.relative.expression.ratio.stats.nofall)
# two-way ANOVA

CTRP1_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CTRP1.relative.expression.ratio.stats)
summary(CTRP1_liver_twoway_anova_results)
Anova(CTRP1_liver_twoway_anova_results)
plot(CTRP1_liver_twoway_anova_results)

CTRP1_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CTRP1.relative.expression.ratio.stats)
summary(CTRP1_liver_twoway_anova_rank)
Anova(CTRP1_liver_twoway_anova_rank)
plot(CTRP1_liver_twoway_anova_rank)

CTRP1_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CTRP1.relative.expression.ratio.r1hrmix)
eta_squared(CTRP1_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CTRP1_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CTRP1_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CTRP1.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CTRP1.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CTRP1.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CTRP1_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CTRP1_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CTRP1.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CTRP1.liver.boxplot <- ggplot(CTRP1.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("CTRP1 - Liver")

print(CTRP1.liver.boxplot)

### Gill -------------------------------------------------------------------
CTRP1.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("CTRP1", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$ctrp %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CTRP1.Gill)

CTRP1.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("CTRP1", "18s"))
         
View(CTRP1.Gill)

CTRP1.Gill.averaged <- CTRP1.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "2G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "3G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "4G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "5G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "6G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "7G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "8G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "9G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "10G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "11G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "12G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "13G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "14G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "15G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "16G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "17G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "18G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "19G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "20G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "21G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "22G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "23G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "24G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "25G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "26G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "27G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "28G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "29G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "30G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "31G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "32G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "33G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "34G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "35G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "36G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "37G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "38G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "39G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "40G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "41G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "42G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "43G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "44G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "45G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "46G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "47G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "48G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "49G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "50G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "51G" & EvaGreen.Name == "CTRP1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "52G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "53G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "54G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "55G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "56G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "57G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "58G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "59G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "60G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "61G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "62G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "63G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "64G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "65G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "66G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "67G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "68G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "69G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "70G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "71G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "72G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "73G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "74G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "75G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "76G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"],
    Sample.Name == "77G" & EvaGreen.Name == "CTRP1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CTRP1"])) 
View(CTRP1.Gill.averaged)
## Control Average
CTRP1.Control <- CTRP1.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CTRP1.Control

## Relative Gene Expression 
CTRP1.Gill.averaged.delta.ct <- CTRP1.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "CTRP1" ~ CTRP1.Control$control.average.ct[CTRP1.Control$EvaGreen.Name=="CTRP1"],
    EvaGreen.Name == "18s" ~ CTRP1.Control$control.average.ct[CTRP1.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CTRP1.gene.expression.ratio <- CTRP1.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="CTRP1"]^delta.ct[EvaGreen.Name=="CTRP1"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "CTRP1")

View(CTRP1.gene.expression.ratio)

CTRP1.Gill.results <- CTRP1.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CTRP1.Gill.results)

CTRP1.relative.expression.ratio <- CTRP1.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CTRP1.Gill.results$average.gene.expression[CTRP1.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CTRP1.Gill.relative.results <- CTRP1.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CTRP1.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CTRP1.relative.expression.ratio.stats <- CTRP1.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(CTRP1.relative.expression.ratio.stats)


# two-way ANOVA

CTRP1_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CTRP1.relative.expression.ratio.stats)
summary(CTRP1_Gill_twoway_anova_results)
Anova(CTRP1_Gill_twoway_anova_results)
plot(CTRP1_Gill_twoway_anova_results)

CTRP1_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CTRP1.relative.expression.ratio.stats)
summary(CTRP1_Gill_twoway_anova_rank)
Anova(CTRP1_Gill_twoway_anova_rank)
plot(CTRP1_Gill_twoway_anova_rank)

CTRP1_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CTRP1.relative.expression.ratio.r1hrmix)
eta_squared(CTRP1_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CTRP1_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CTRP1_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CTRP1.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CTRP1.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CTRP1.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CTRP1_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CTRP1_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CTRP1.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CTRP1.Gill.boxplot <- ggplot(CTRP1.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("CTRP1 - Gill")

print(CTRP1.Gill.boxplot)

###report stats------------------------------------

CTRP1_gill_stats <- CTRP1.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(CTRP1_gill_stats)

## CAT -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
CAT.liver <- liver %>%
  filter(EvaGreen.Name %in% c("CAT", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$cat %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CAT.liver)

CAT.liver <- liver %>%
  filter(EvaGreen.Name %in% c("CAT", "18s"))
         
View(CAT.liver)

CAT.liver.averaged <- CAT.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "2L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "3L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "4L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "5L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "6L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "7L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "8L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "9L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "10L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "11L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "12L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "13L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "14L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "15L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "16L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "17L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "18L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "19L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "20L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "21L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "22L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "23L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "24L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "25L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "26L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "27L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "28L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "29L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "30L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "31L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "32L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "33L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "34L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "35L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "36L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "37L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "38L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "39L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "40L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "41L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "42L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "43L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "44L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "45L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "46L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "47L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "48L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "49L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "50L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "51L" & EvaGreen.Name == "CAT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "52L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "53L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "54L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "55L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "56L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "57L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "58L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "59L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "60L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "61L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "62L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "63L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "64L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "65L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "66L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "67L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "68L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "69L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "70L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "71L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "72L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "73L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "74L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "75L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "76L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"],
    Sample.Name == "77L" & EvaGreen.Name == "CAT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CAT"])) 
View(CAT.liver.averaged)
## Control Average
CAT.Control <- CAT.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CAT.Control

## Relative Gene Expression 
CAT.liver.averaged.delta.ct <- CAT.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "CAT" ~ CAT.Control$control.average.ct[CAT.Control$EvaGreen.Name=="CAT"],
    EvaGreen.Name == "18s" ~ CAT.Control$control.average.ct[CAT.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CAT.gene.expression.ratio <- CAT.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="CAT"]^delta.ct[EvaGreen.Name=="CAT"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "CAT")

View(CAT.gene.expression.ratio)

CAT.liver.results <- CAT.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CAT.liver.results)

CAT.relative.expression.ratio <- CAT.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CAT.liver.results$average.gene.expression[CAT.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CAT.liver.relative.results <- CAT.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CAT.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CAT.relative.expression.ratio.stats <- CAT.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(CAT.relative.expression.ratio.stats)

CAT.relative.expression.ratio.stats.nofall <- CAT.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(CAT.relative.expression.ratio.stats.nofall)
# two-way ANOVA

CAT_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CAT.relative.expression.ratio.stats)
summary(CAT_liver_twoway_anova_results)
Anova(CAT_liver_twoway_anova_results)
plot(CAT_liver_twoway_anova_results)

CAT_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CAT.relative.expression.ratio.stats)
summary(CAT_liver_twoway_anova_rank)
Anova(CAT_liver_twoway_anova_rank)
plot(CAT_liver_twoway_anova_rank)

CAT_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CAT.relative.expression.ratio.r1hrmix)
eta_squared(CAT_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CAT_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CAT_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CAT.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CAT.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CAT.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CAT_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CAT_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CAT.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CAT.liver.boxplot <- ggplot(CAT.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("CAT - Liver")

print(CAT.liver.boxplot)

###report stats------------------------------------

CAT_liver_stats <- CAT.relative.expression.ratio.stats.nofall %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(CAT_liver_stats)

### Gill -------------------------------------------------------------------
CAT.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("CAT", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$cat %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CAT.Gill)

CAT.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("CAT", "18s"))
         
View(CAT.Gill)

CAT.Gill.averaged <- CAT.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "2G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "3G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "4G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "5G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "6G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "7G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "8G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "9G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "10G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "11G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "12G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "13G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "14G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "15G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "16G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "17G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "18G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "19G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "20G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "21G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "22G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "23G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "24G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "25G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "26G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "27G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "28G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "29G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "30G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "31G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "32G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "33G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "34G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "35G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "36G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "37G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "38G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "39G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "40G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "41G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "42G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "43G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "44G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "45G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "46G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "47G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "48G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "49G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "50G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "51G" & EvaGreen.Name == "CAT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "52G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "53G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "54G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "55G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "56G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "57G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "58G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "59G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "60G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "61G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "62G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "63G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "64G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "65G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "66G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "67G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "68G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "69G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "70G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "71G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "72G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "73G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "74G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "75G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "76G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"],
    Sample.Name == "77G" & EvaGreen.Name == "CAT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CAT"])) 
View(CAT.Gill.averaged)
## Control Average
CAT.Control <- CAT.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CAT.Control

## Relative Gene Expression 
CAT.Gill.averaged.delta.ct <- CAT.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "CAT" ~ CAT.Control$control.average.ct[CAT.Control$EvaGreen.Name=="CAT"],
    EvaGreen.Name == "18s" ~ CAT.Control$control.average.ct[CAT.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CAT.gene.expression.ratio <- CAT.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="CAT"]^delta.ct[EvaGreen.Name=="CAT"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "CAT")

View(CAT.gene.expression.ratio)

CAT.Gill.results <- CAT.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CAT.Gill.results)

CAT.relative.expression.ratio <- CAT.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CAT.Gill.results$average.gene.expression[CAT.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CAT.Gill.relative.results <- CAT.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CAT.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CAT.relative.expression.ratio.stats <- CAT.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(CAT.relative.expression.ratio.stats)


# two-way ANOVA

CAT_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CAT.relative.expression.ratio.stats)
summary(CAT_Gill_twoway_anova_results)
Anova(CAT_Gill_twoway_anova_results)
plot(CAT_Gill_twoway_anova_results)

CAT_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CAT.relative.expression.ratio.stats)
summary(CAT_Gill_twoway_anova_rank)
Anova(CAT_Gill_twoway_anova_rank)
plot(CAT_Gill_twoway_anova_rank)

CAT_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CAT.relative.expression.ratio.r1hrmix)
eta_squared(CAT_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CAT_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CAT_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CAT.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CAT.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CAT.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CAT_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CAT_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CAT.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CAT.Gill.boxplot <- ggplot(CAT.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("CAT - Gill")

print(CAT.Gill.boxplot)

###report stats------------------------------------

CAT_gill_stats <- CAT.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(CAT_gill_stats)

## GADD45 -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
GADD45.liver <- liver %>%
  filter(EvaGreen.Name %in% c("GADD45", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$gadd %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(GADD45.liver)

GADD45.liver <- liver %>%
  filter(EvaGreen.Name %in% c("GADD45", "18s"))
         
View(GADD45.liver)

GADD45.liver.averaged <- GADD45.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "2L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "3L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "4L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "5L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "6L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "7L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "8L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "9L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "10L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "11L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "12L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "13L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "14L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "15L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "16L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "17L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "18L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "19L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "20L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "21L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "22L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "23L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "24L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "25L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "26L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "27L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "28L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "29L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "30L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "31L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "32L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "33L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "34L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "35L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "36L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "37L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "38L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "39L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "40L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "41L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "42L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "43L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "44L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "45L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "46L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "47L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "48L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "49L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "50L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "51L" & EvaGreen.Name == "GADD45" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "52L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "53L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "54L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "55L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "56L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "57L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "58L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "59L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "60L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "61L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "62L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "63L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "64L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "65L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "66L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "67L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "68L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "69L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "70L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "71L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "72L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "73L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "74L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "75L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "76L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"],
    Sample.Name == "77L" & EvaGreen.Name == "GADD45"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GADD45"])) 
View(GADD45.liver.averaged)
## Control Average
GADD45.Control <- GADD45.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

GADD45.Control

## Relative Gene Expression 
GADD45.liver.averaged.delta.ct <- GADD45.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "GADD45" ~ GADD45.Control$control.average.ct[GADD45.Control$EvaGreen.Name=="GADD45"],
    EvaGreen.Name == "18s" ~ GADD45.Control$control.average.ct[GADD45.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

GADD45.gene.expression.ratio <- GADD45.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="GADD45"]^delta.ct[EvaGreen.Name=="GADD45"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "GADD45")

View(GADD45.gene.expression.ratio)

GADD45.liver.results <- GADD45.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(GADD45.liver.results)

GADD45.relative.expression.ratio <- GADD45.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = GADD45.liver.results$average.gene.expression[GADD45.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

GADD45.liver.relative.results <- GADD45.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
GADD45.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

GADD45.relative.expression.ratio.stats <- GADD45.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(GADD45.relative.expression.ratio.stats)

GADD45.relative.expression.ratio.stats.nofall <- GADD45.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(GADD45.relative.expression.ratio.stats.nofall)
# two-way ANOVA

GADD45_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = GADD45.relative.expression.ratio.stats)
summary(GADD45_liver_twoway_anova_results)
Anova(GADD45_liver_twoway_anova_results)
plot(GADD45_liver_twoway_anova_results)

GADD45_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = GADD45.relative.expression.ratio.stats)
summary(GADD45_liver_twoway_anova_rank)
Anova(GADD45_liver_twoway_anova_rank)
plot(GADD45_liver_twoway_anova_rank)

GADD45_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = GADD45.relative.expression.ratio.r1hrmix)
eta_squared(GADD45_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(GADD45_liver_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(GADD45_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = GADD45.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=GADD45.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=GADD45.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(GADD45_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(GADD45_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- GADD45.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


GADD45.liver.boxplot <- ggplot(GADD45.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("GADD45 - Liver")

print(GADD45.liver.boxplot)

### Gill -------------------------------------------------------------------
GADD45.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("GADD45", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$gadd %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(GADD45.Gill)

GADD45.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("GADD45", "18s"))
         
View(GADD45.Gill)

GADD45.Gill.averaged <- GADD45.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "2G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "3G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "4G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "5G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "6G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "7G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "8G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "9G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "10G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "11G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "12G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "13G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "14G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "15G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "16G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "17G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "18G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "19G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "20G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "21G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "22G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "23G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "24G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "25G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "26G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "27G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "28G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "29G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "30G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "31G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "32G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "33G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "34G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "35G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "36G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "37G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "38G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "39G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "40G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "41G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "42G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "43G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "44G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "45G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "46G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "47G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "48G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "49G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "50G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "51G" & EvaGreen.Name == "GADD45" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "52G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "53G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "54G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "55G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "56G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "57G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "58G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "59G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "60G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "61G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "62G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "63G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "64G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "65G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "66G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "67G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "68G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "69G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "70G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "71G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "72G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "73G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "74G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "75G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "76G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"],
    Sample.Name == "77G" & EvaGreen.Name == "GADD45"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GADD45"])) 
View(GADD45.Gill.averaged)
## Control Average
GADD45.Control <- GADD45.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

GADD45.Control

## Relative Gene Expression 
GADD45.Gill.averaged.delta.ct <- GADD45.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "GADD45" ~ GADD45.Control$control.average.ct[GADD45.Control$EvaGreen.Name=="GADD45"],
    EvaGreen.Name == "18s" ~ GADD45.Control$control.average.ct[GADD45.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

GADD45.gene.expression.ratio <- GADD45.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="GADD45"]^delta.ct[EvaGreen.Name=="GADD45"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "GADD45")

View(GADD45.gene.expression.ratio)

GADD45.Gill.results <- GADD45.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(GADD45.Gill.results)

GADD45.relative.expression.ratio <- GADD45.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = GADD45.Gill.results$average.gene.expression[GADD45.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

GADD45.Gill.relative.results <- GADD45.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
GADD45.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

GADD45.relative.expression.ratio.stats <- GADD45.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(GADD45.relative.expression.ratio.stats)


# two-way ANOVA

GADD45_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = GADD45.relative.expression.ratio.stats)
summary(GADD45_Gill_twoway_anova_results)
Anova(GADD45_Gill_twoway_anova_results)
plot(GADD45_Gill_twoway_anova_results)

GADD45_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = GADD45.relative.expression.ratio.stats)
summary(GADD45_Gill_twoway_anova_rank)
Anova(GADD45_Gill_twoway_anova_rank)
plot(GADD45_Gill_twoway_anova_rank)

GADD45_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = GADD45.relative.expression.ratio.r1hrmix)
eta_squared(GADD45_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(GADD45_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(GADD45_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = GADD45.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=GADD45.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=GADD45.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(GADD45_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(GADD45_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- GADD45.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


GADD45.Gill.boxplot <- ggplot(GADD45.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("GADD45 - Gill")

print(GADD45.Gill.boxplot)

###report stats------------------------------------

GADD45_gill_stats <- GADD45.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(GADD45_gill_stats)

## MT -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
MT.liver <- liver %>%
  filter(EvaGreen.Name %in% c("MT", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$mt %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(MT.liver)

MT.liver.averaged <- MT.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "2L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "3L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "4L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "5L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "6L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "7L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "8L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "9L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "10L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "11L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "12L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "13L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "14L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "15L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "16L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "17L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "18L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "19L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "20L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "21L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "22L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "23L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "24L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "25L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "26L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "27L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "28L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "29L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "30L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "31L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "32L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "33L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "34L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "35L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "36L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "37L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "38L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "39L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "40L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "41L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "42L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "43L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "44L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "45L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "46L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "47L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "48L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "49L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "50L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "51L" & EvaGreen.Name == "MT" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "52L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "53L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "54L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "55L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "56L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "57L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "58L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "59L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "60L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "61L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "62L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "63L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "64L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "65L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "66L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "67L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "68L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "69L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "70L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "71L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "72L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "73L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "74L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "75L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "76L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"],
    Sample.Name == "77L" & EvaGreen.Name == "MT"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MT"])) 
View(MT.liver.averaged)
## Control Average
MT.Control <- MT.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

MT.Control

## Relative Gene Expression 
MT.liver.averaged.delta.ct <- MT.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "MT" ~ MT.Control$control.average.ct[MT.Control$EvaGreen.Name=="MT"],
    EvaGreen.Name == "18s" ~ MT.Control$control.average.ct[MT.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

MT.gene.expression.ratio <- MT.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="MT"]^delta.ct[EvaGreen.Name=="MT"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "MT")

View(MT.gene.expression.ratio)

MT.liver.results <- MT.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(MT.liver.results)

MT.relative.expression.ratio <- MT.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = MT.liver.results$average.gene.expression[MT.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

MT.liver.relative.results <- MT.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
MT.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

MT.relative.expression.ratio.stats <- MT.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(MT.relative.expression.ratio.stats)

MT.relative.expression.ratio.stats.nofall <- MT.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(MT.relative.expression.ratio.stats.nofall)
# two-way ANOVA

MT_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = MT.relative.expression.ratio.stats.nofall)
summary(MT_liver_twoway_anova_results)
Anova(MT_liver_twoway_anova_results)
plot(MT_liver_twoway_anova_results)

MT_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = MT.relative.expression.ratio.stats)
summary(MT_liver_twoway_anova_rank)
Anova(MT_liver_twoway_anova_rank)
plot(MT_liver_twoway_anova_rank)

MT_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = MT.relative.expression.ratio.r1hrmix)
eta_squared(MT_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(MT_liver_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(MT_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = MT.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=MT.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=MT.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(MT_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(MT_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- MT.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


MT.liver.boxplot <- ggplot(MT.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("MT - Liver")

print(MT.liver.boxplot)

### Gill -------------------------------------------------------------------
MT.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("MT", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$mt %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(MT.Gill)

MT.Gill.averaged <- MT.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "2G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "3G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "4G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "5G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "6G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "7G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "8G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "9G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "10G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "11G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "12G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "13G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "14G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "15G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "16G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "17G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "18G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "19G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "20G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "21G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "22G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "23G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "24G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "25G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "26G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "27G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "28G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "29G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "30G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "31G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "32G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "33G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "34G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "35G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "36G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "37G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "38G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "39G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "40G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "41G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "42G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "43G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "44G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "45G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "46G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "47G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "48G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "49G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "50G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "51G" & EvaGreen.Name == "MT" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "52G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "53G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "54G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "55G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "56G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "57G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "58G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "59G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "60G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "61G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "62G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "63G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "64G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "65G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "66G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "67G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "68G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "69G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "70G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "71G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "72G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "73G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "74G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "75G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "76G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"],
    Sample.Name == "77G" & EvaGreen.Name == "MT"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MT"])) 
View(MT.Gill.averaged)
## Control Average
MT.Control <- MT.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

MT.Control

## Relative Gene Expression 
MT.Gill.averaged.delta.ct <- MT.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "MT" ~ MT.Control$control.average.ct[MT.Control$EvaGreen.Name=="MT"],
    EvaGreen.Name == "18s" ~ MT.Control$control.average.ct[MT.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

MT.gene.expression.ratio <- MT.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="MT"]^delta.ct[EvaGreen.Name=="MT"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "MT")

View(MT.gene.expression.ratio)

MT.Gill.results <- MT.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(MT.Gill.results)

MT.relative.expression.ratio <- MT.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = MT.Gill.results$average.gene.expression[MT.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

MT.Gill.relative.results <- MT.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
MT.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

MT.relative.expression.ratio.stats <- MT.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(MT.relative.expression.ratio.stats)


# two-way ANOVA

MT_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = MT.relative.expression.ratio.stats)
summary(MT_Gill_twoway_anova_results)
Anova(MT_Gill_twoway_anova_results)
plot(MT_Gill_twoway_anova_results)

MT_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = MT.relative.expression.ratio.stats)
summary(MT_Gill_twoway_anova_rank)
Anova(MT_Gill_twoway_anova_rank)
plot(MT_Gill_twoway_anova_rank)

MT_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = MT.relative.expression.ratio.r1hrmix)
eta_squared(MT_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(MT_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(MT_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = MT.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=MT.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=MT.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(MT_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(MT_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- MT.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


MT.Gill.boxplot <- ggplot(MT.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("MT - Gill")

print(MT.Gill.boxplot)

## RAD51 -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
RAD51.liver <- liver %>%
  filter(EvaGreen.Name %in% c("RAD51", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rad51 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(RAD51.liver)

RAD51.liver <- liver %>%
  filter(EvaGreen.Name %in% c("RAD51", "18s"))
         
View(RAD51.liver)

RAD51.liver.averaged <- RAD51.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "2L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "3L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "4L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "5L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "6L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "7L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "8L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "9L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "10L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "11L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "12L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "13L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "14L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "15L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "16L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "17L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "18L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "19L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "20L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "21L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "22L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "23L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "24L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "25L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "26L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "27L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "28L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "29L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "30L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "31L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "32L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "33L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "34L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "35L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "36L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "37L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "38L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "39L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "40L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "41L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "42L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "43L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "44L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "45L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "46L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "47L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "48L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "49L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "50L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "51L" & EvaGreen.Name == "RAD51" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "52L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "53L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "54L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "55L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "56L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "57L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "58L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "59L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "60L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "61L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "62L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "63L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "64L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "65L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "66L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "67L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "68L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "69L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "70L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "71L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "72L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "73L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "74L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "75L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "76L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"],
    Sample.Name == "77L" & EvaGreen.Name == "RAD51"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="RAD51"])) 
View(RAD51.liver.averaged)
## Control Average
RAD51.Control <- RAD51.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

RAD51.Control

## Relative Gene Expression 
RAD51.liver.averaged.delta.ct <- RAD51.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "RAD51" ~ RAD51.Control$control.average.ct[RAD51.Control$EvaGreen.Name=="RAD51"],
    EvaGreen.Name == "18s" ~ RAD51.Control$control.average.ct[RAD51.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

RAD51.gene.expression.ratio <- RAD51.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="RAD51"]^delta.ct[EvaGreen.Name=="RAD51"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "RAD51")

View(RAD51.gene.expression.ratio)

RAD51.liver.results <- RAD51.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(RAD51.liver.results)

RAD51.relative.expression.ratio <- RAD51.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = RAD51.liver.results$average.gene.expression[RAD51.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

RAD51.liver.relative.results <- RAD51.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
RAD51.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

RAD51.relative.expression.ratio.stats <- RAD51.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(RAD51.relative.expression.ratio.stats)

RAD51.relative.expression.ratio.stats.nofall <- RAD51.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(RAD51.relative.expression.ratio.stats.nofall)
# two-way ANOVA

RAD51_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = RAD51.relative.expression.ratio.stats)
summary(RAD51_liver_twoway_anova_results)
Anova(RAD51_liver_twoway_anova_results)
plot(RAD51_liver_twoway_anova_results)

RAD51_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = RAD51.relative.expression.ratio.stats)
summary(RAD51_liver_twoway_anova_rank)
Anova(RAD51_liver_twoway_anova_rank)
plot(RAD51_liver_twoway_anova_rank)

RAD51_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = RAD51.relative.expression.ratio.r1hrmix)
eta_squared(RAD51_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(RAD51_liver_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(RAD51_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = RAD51.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=RAD51.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=RAD51.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(RAD51_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(RAD51_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- RAD51.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


RAD51.liver.boxplot <- ggplot(RAD51.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("RAD51 - Liver")

print(RAD51.liver.boxplot)

### Gill -------------------------------------------------------------------
RAD51.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("RAD51", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rad51 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(RAD51.Gill)

RAD51.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("RAD51", "18s"))
         
View(RAD51.Gill)

RAD51.Gill.averaged <- RAD51.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "2G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "3G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "4G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "5G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "6G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "7G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "8G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "9G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "10G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "11G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "12G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "13G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "14G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "15G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "16G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "17G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "18G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "19G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "20G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "21G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "22G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "23G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "24G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "25G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "26G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "27G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "28G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "29G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "30G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "31G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "32G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "33G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "34G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "35G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "36G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "37G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "38G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "39G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "40G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "41G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "42G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "43G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "44G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "45G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "46G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "47G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "48G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "49G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "50G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "51G" & EvaGreen.Name == "RAD51" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "52G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "53G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "54G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "55G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "56G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "57G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "58G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "59G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "60G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "61G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "62G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "63G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "64G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "65G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "66G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "67G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "68G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "69G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "70G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "71G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "72G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "73G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "74G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "75G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "76G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"],
    Sample.Name == "77G" & EvaGreen.Name == "RAD51"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="RAD51"])) 
View(RAD51.Gill.averaged)
## Control Average
RAD51.Control <- RAD51.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

RAD51.Control

## Relative Gene Expression 
RAD51.Gill.averaged.delta.ct <- RAD51.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "RAD51" ~ RAD51.Control$control.average.ct[RAD51.Control$EvaGreen.Name=="RAD51"],
    EvaGreen.Name == "18s" ~ RAD51.Control$control.average.ct[RAD51.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

RAD51.gene.expression.ratio <- RAD51.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="RAD51"]^delta.ct[EvaGreen.Name=="RAD51"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "RAD51")

View(RAD51.gene.expression.ratio)

RAD51.Gill.results <- RAD51.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(RAD51.Gill.results)

RAD51.relative.expression.ratio <- RAD51.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = RAD51.Gill.results$average.gene.expression[RAD51.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

RAD51.Gill.relative.results <- RAD51.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
RAD51.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

RAD51.relative.expression.ratio.stats <- RAD51.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(RAD51.relative.expression.ratio.stats)


# two-way ANOVA

RAD51_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = RAD51.relative.expression.ratio.stats)
summary(RAD51_Gill_twoway_anova_results)
Anova(RAD51_Gill_twoway_anova_results)
plot(RAD51_Gill_twoway_anova_results)

RAD51_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = RAD51.relative.expression.ratio.stats)
summary(RAD51_Gill_twoway_anova_rank)
Anova(RAD51_Gill_twoway_anova_rank)
plot(RAD51_Gill_twoway_anova_rank)

RAD51_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = RAD51.relative.expression.ratio.r1hrmix)
eta_squared(RAD51_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(RAD51_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(RAD51_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = RAD51.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=RAD51.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=RAD51.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(RAD51_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(RAD51_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- RAD51.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


RAD51.Gill.boxplot <- ggplot(RAD51.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("RAD51 - Gill")

print(RAD51.Gill.boxplot)

###report stats------------------------------------

RAD51_gill_stats <- RAD51.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(RAD51_gill_stats)

## MCL1 -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
MCL1.liver <- liver %>%
  filter(EvaGreen.Name %in% c("MCL1", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$mcl %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(MCL1.liver)

MCL1.liver <- liver %>%
  filter(EvaGreen.Name %in% c("MCL1", "18s"))
         
View(MCL1.liver)

MCL1.liver.averaged <- MCL1.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "2L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "3L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "4L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "5L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "6L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "7L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "8L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "9L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "10L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "11L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "12L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "13L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "14L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "15L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "16L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "17L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "18L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "19L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "20L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "21L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "22L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "23L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "24L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "25L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "26L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "27L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "28L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "29L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "30L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "31L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "32L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "33L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "34L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "35L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "36L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "37L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "38L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "39L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "40L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "41L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "42L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "43L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "44L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "45L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "46L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "47L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "48L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "49L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "50L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "51L" & EvaGreen.Name == "MCL1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "52L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "53L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "54L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "55L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "56L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "57L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "58L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "59L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "60L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "61L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "62L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "63L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "64L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "65L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "66L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "67L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "68L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "69L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "70L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "71L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "72L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "73L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "74L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "75L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "76L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"],
    Sample.Name == "77L" & EvaGreen.Name == "MCL1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="MCL1"])) 
View(MCL1.liver.averaged)
## Control Average
MCL1.Control <- MCL1.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

MCL1.Control

## Relative Gene Expression 
MCL1.liver.averaged.delta.ct <- MCL1.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "MCL1" ~ MCL1.Control$control.average.ct[MCL1.Control$EvaGreen.Name=="MCL1"],
    EvaGreen.Name == "18s" ~ MCL1.Control$control.average.ct[MCL1.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

MCL1.gene.expression.ratio <- MCL1.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="MCL1"]^delta.ct[EvaGreen.Name=="MCL1"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "MCL1")

View(MCL1.gene.expression.ratio)

MCL1.liver.results <- MCL1.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(MCL1.liver.results)

MCL1.relative.expression.ratio <- MCL1.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = MCL1.liver.results$average.gene.expression[MCL1.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

MCL1.liver.relative.results <- MCL1.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
MCL1.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

MCL1.relative.expression.ratio.stats <- MCL1.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(MCL1.relative.expression.ratio.stats)

MCL1.relative.expression.ratio.stats.nofall <- MCL1.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(MCL1.relative.expression.ratio.stats.nofall)
# two-way ANOVA

MCL1_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = MCL1.relative.expression.ratio.stats)
summary(MCL1_liver_twoway_anova_results)
Anova(MCL1_liver_twoway_anova_results)
plot(MCL1_liver_twoway_anova_results)

MCL1_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = MCL1.relative.expression.ratio.stats)
summary(MCL1_liver_twoway_anova_rank)
Anova(MCL1_liver_twoway_anova_rank)
plot(MCL1_liver_twoway_anova_rank)

MCL1_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = MCL1.relative.expression.ratio.r1hrmix)
eta_squared(MCL1_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(MCL1_liver_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(MCL1_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = MCL1.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=MCL1.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=MCL1.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(MCL1_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(MCL1_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- MCL1.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


MCL1.liver.boxplot <- ggplot(MCL1.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("MCL1 - Liver")

print(MCL1.liver.boxplot)

###report stats------------------------------------

MCL1_liver_stats <- MCL1.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(MCL1_liver_stats)

### Gill -------------------------------------------------------------------
MCL1.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("MCL1", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$mcl %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(MCL1.Gill)

MCL1.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("MCL1", "18s"))
        
View(MCL1.Gill)

MCL1.Gill.averaged <- MCL1.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "2G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "3G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "4G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "5G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "6G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "7G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "8G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "9G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "10G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "11G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "12G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "13G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "14G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "15G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "16G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "17G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "18G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "19G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "20G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "21G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "22G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "23G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "24G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "25G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "26G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "27G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "28G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "29G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "30G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "31G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "32G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "33G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "34G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "35G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "36G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "37G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "38G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "39G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "40G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "41G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "42G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "43G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "44G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "45G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "46G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "47G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "48G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "49G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "50G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "51G" & EvaGreen.Name == "MCL1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "52G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "53G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "54G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "55G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "56G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "57G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "58G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "59G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "60G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "61G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "62G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "63G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "64G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "65G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "66G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "67G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "68G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "69G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "70G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "71G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "72G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "73G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "74G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "75G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "76G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"],
    Sample.Name == "77G" & EvaGreen.Name == "MCL1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="MCL1"])) 
View(MCL1.Gill.averaged)
## Control Average
MCL1.Control <- MCL1.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

MCL1.Control

## Relative Gene Expression 
MCL1.Gill.averaged.delta.ct <- MCL1.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "MCL1" ~ MCL1.Control$control.average.ct[MCL1.Control$EvaGreen.Name=="MCL1"],
    EvaGreen.Name == "18s" ~ MCL1.Control$control.average.ct[MCL1.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

MCL1.gene.expression.ratio <- MCL1.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="MCL1"]^delta.ct[EvaGreen.Name=="MCL1"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "MCL1")

View(MCL1.gene.expression.ratio)

MCL1.Gill.results <- MCL1.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(MCL1.Gill.results)

MCL1.relative.expression.ratio <- MCL1.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = MCL1.Gill.results$average.gene.expression[MCL1.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

MCL1.Gill.relative.results <- MCL1.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
MCL1.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

MCL1.relative.expression.ratio.stats <- MCL1.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(MCL1.relative.expression.ratio.stats)


# two-way ANOVA

MCL1_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = MCL1.relative.expression.ratio.stats)
summary(MCL1_Gill_twoway_anova_results)
Anova(MCL1_Gill_twoway_anova_results)
plot(MCL1_Gill_twoway_anova_results)

MCL1_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = MCL1.relative.expression.ratio.stats)
summary(MCL1_Gill_twoway_anova_rank)
Anova(MCL1_Gill_twoway_anova_rank)
plot(MCL1_Gill_twoway_anova_rank)

MCL1_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = MCL1.relative.expression.ratio.r1hrmix)
eta_squared(MCL1_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(MCL1_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(MCL1_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = MCL1.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=MCL1.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=MCL1.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(MCL1_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(MCL1_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- MCL1.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


MCL1.Gill.boxplot <- ggplot(MCL1.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("MCL1 - Gill")

print(MCL1.Gill.boxplot)

###report stats------------------------------------

MCL1_gill_stats <- MCL1.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(MCL1_gill_stats)

## CJUN -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
CJUN.liver <- liver %>%
  filter(EvaGreen.Name %in% c("C-JUN", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$cjun %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CJUN.liver)

CJUN.liver <- liver %>%
  filter(EvaGreen.Name %in% c("C-JUN", "18s"))
        
View(CJUN.liver)

CJUN.liver.averaged.summer <- CJUN.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "2L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "3L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "4L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "5L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "6L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "7L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "8L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "9L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "10L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "11L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "12L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "13L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "14L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "15L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "16L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "17L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "18L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "19L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "20L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "21L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "22L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "23L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "24L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "25L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "26L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "27L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "28L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "29L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "30L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "31L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "32L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "33L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "34L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "35L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "36L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "37L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "38L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "39L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "40L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "41L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "42L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "43L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "44L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "45L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "46L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "47L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "48L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "49L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "50L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "51L" & EvaGreen.Name == "C-JUN" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "52L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "53L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "54L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "55L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "56L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "57L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "58L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "59L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "60L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "61L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "62L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "63L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "64L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "65L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "66L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "67L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "68L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "69L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "70L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "71L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "72L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "73L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "74L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "75L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "76L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"],
    Sample.Name == "77L" & EvaGreen.Name == "C-JUN"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-JUN"])) 
View(CJUN.liver.averaged.summer)

##remove spring and fall
CJUN.liver.averaged <- CJUN.liver.averaged.summer %>%
  filter(Season != "Spring") 
View(CJUN.liver.averaged)

## Control Average
CJUN.Control <- CJUN.liver.averaged %>%
  filter(Treatment == "La_Grange_Summer") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CJUN.Control

## Relative Gene Expression 
CJUN.liver.averaged.delta.ct <- CJUN.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "C-JUN" ~ CJUN.Control$control.average.ct[CJUN.Control$EvaGreen.Name=="C-JUN"],
    EvaGreen.Name == "18s" ~ CJUN.Control$control.average.ct[CJUN.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CJUN.gene.expression.ratio <- CJUN.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="C-JUN"]^delta.ct[EvaGreen.Name=="C-JUN"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "C-JUN")

View(CJUN.gene.expression.ratio)

CJUN.liver.results <- CJUN.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CJUN.liver.results)

CJUN.relative.expression.ratio <- CJUN.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CJUN.liver.results$average.gene.expression[CJUN.liver.results$Treatment=="La_Grange_Summer"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CJUN.liver.relative.results <- CJUN.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CJUN.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CJUN.relative.expression.ratio.stats <- CJUN.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(CJUN.relative.expression.ratio.stats)

# two-way ANOVA

CJUN_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CJUN.relative.expression.ratio.stats)
summary(CJUN_liver_twoway_anova_results)
Anova(CJUN_liver_twoway_anova_results)
plot(CJUN_liver_twoway_anova_results)

CJUN_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CJUN.relative.expression.ratio.stats)
summary(CJUN_liver_twoway_anova_rank)
Anova(CJUN_liver_twoway_anova_rank)
plot(CJUN_liver_twoway_anova_rank)

CJUN_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CJUN.relative.expression.ratio.r1hrmix)
eta_squared(CJUN_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CJUN_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CJUN_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CJUN.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CJUN.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CJUN.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CJUN_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CJUN_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CJUN.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CJUN.liver.boxplot <- ggplot(CJUN.relative.expression.ratio.stats, aes(y=log2(relative.expression), x=Pool)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("C-JUN - Liver")

print(CJUN.liver.boxplot)

### Gill -------------------------------------------------------------------
CJUN.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("C-JUN", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$cjun %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CJUN.Gill)

CJUN.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("C-JUN", "18s"))
        
View(CJUN.Gill)

CJUN.Gill.averaged <- CJUN.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "2G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "3G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "4G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "5G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "6G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "7G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "8G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "9G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "10G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "11G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "12G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "13G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "14G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "15G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "16G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "17G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "18G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "19G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "20G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "21G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "22G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "23G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "24G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "25G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "26G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "27G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "28G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "29G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "30G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "31G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "32G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "33G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "34G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "35G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "36G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "37G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "38G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "39G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "40G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "41G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "42G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "43G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "44G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "45G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "46G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "47G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "48G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "49G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "50G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "51G" & EvaGreen.Name == "C-JUN" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "52G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "53G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "54G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "55G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "56G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "57G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "58G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "59G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "60G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "61G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "62G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "63G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "64G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "65G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "66G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "67G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "68G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "69G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "70G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "71G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "72G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "73G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "74G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "75G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "76G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"],
    Sample.Name == "77G" & EvaGreen.Name == "C-JUN"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-JUN"])) 
View(CJUN.Gill.averaged)
## Control Average
CJUN.Control <- CJUN.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CJUN.Control

## Relative Gene Expression 
CJUN.Gill.averaged.delta.ct <- CJUN.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "C-JUN" ~ CJUN.Control$control.average.ct[CJUN.Control$EvaGreen.Name=="C-JUN"],
    EvaGreen.Name == "18s" ~ CJUN.Control$control.average.ct[CJUN.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CJUN.gene.expression.ratio <- CJUN.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="C-JUN"]^delta.ct[EvaGreen.Name=="C-JUN"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "C-JUN")

View(CJUN.gene.expression.ratio)

CJUN.Gill.results <- CJUN.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CJUN.Gill.results)

CJUN.relative.expression.ratio <- CJUN.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CJUN.Gill.results$average.gene.expression[CJUN.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CJUN.Gill.relative.results <- CJUN.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CJUN.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CJUN.relative.expression.ratio.stats <- CJUN.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(CJUN.relative.expression.ratio.stats)


# two-way ANOVA

CJUN_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CJUN.relative.expression.ratio.stats)
summary(CJUN_Gill_twoway_anova_results)
Anova(CJUN_Gill_twoway_anova_results)
plot(CJUN_Gill_twoway_anova_results)

CJUN_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CJUN.relative.expression.ratio.stats)
summary(CJUN_Gill_twoway_anova_rank)
Anova(CJUN_Gill_twoway_anova_rank)
plot(CJUN_Gill_twoway_anova_rank)

CJUN_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CJUN.relative.expression.ratio.r1hrmix)
eta_squared(CJUN_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CJUN_Gill_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CJUN_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
pwpp(emmeans_result)
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CJUN.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CJUN.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CJUN.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CJUN_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CJUN_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CJUN.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CJUN.Gill.boxplot <- ggplot(CJUN.relative.expression.ratio.stats, aes(y=log2(relative.expression), x=Pool, fill = Season)) +
  geom_boxplot() +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("CJUN - Gill")

print(CJUN.Gill.boxplot)

###report stats------------------------------------

CJUN_gill_stats <- CJUN.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(CJUN_gill_stats)

log2(CJUN_gill_stats$mean)
## CFOS -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
CFOS.liver <- liver %>%
  filter(EvaGreen.Name %in% c("C-FOS", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$cfos %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CFOS.liver)

CFOS.liver <- liver %>%
  filter(EvaGreen.Name %in% c("C-FOS", "18s"))
         
View(CFOS.liver)

CFOS.liver.averaged <- CFOS.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "2L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "3L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "4L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "5L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "6L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "7L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "8L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "9L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "10L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "11L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "12L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "13L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "14L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "15L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "16L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "17L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "18L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "19L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "20L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "21L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "22L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "23L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "24L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "25L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "26L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "27L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "28L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "29L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "30L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "31L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "32L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "33L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "34L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "35L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "36L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "37L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "38L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "39L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "40L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "41L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "42L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "43L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "44L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "45L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "46L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "47L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "48L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "49L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "50L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "51L" & EvaGreen.Name == "C-FOS" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "52L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "53L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "54L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "55L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "56L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "57L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "58L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "59L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "60L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "61L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "62L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "63L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "64L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "65L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "66L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "67L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "68L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "69L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "70L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "71L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "72L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "73L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "74L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "75L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "76L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"],
    Sample.Name == "77L" & EvaGreen.Name == "C-FOS"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="C-FOS"])) 
View(CFOS.liver.averaged)
## Control Average
CFOS.Control <- CFOS.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CFOS.Control

## Relative Gene Expression 
CFOS.liver.averaged.delta.ct <- CFOS.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "C-FOS" ~ CFOS.Control$control.average.ct[CFOS.Control$EvaGreen.Name=="C-FOS"],
    EvaGreen.Name == "18s" ~ CFOS.Control$control.average.ct[CFOS.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CFOS.gene.expression.ratio <- CFOS.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="C-FOS"]^delta.ct[EvaGreen.Name=="C-FOS"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "C-FOS")

View(CFOS.gene.expression.ratio)

CFOS.liver.results <- CFOS.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CFOS.liver.results)

CFOS.relative.expression.ratio <- CFOS.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CFOS.liver.results$average.gene.expression[CFOS.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CFOS.liver.relative.results <- CFOS.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CFOS.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CFOS.relative.expression.ratio.stats <- CFOS.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(CFOS.relative.expression.ratio.stats)

CFOS.relative.expression.ratio.stats.nofall <- CFOS.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(CFOS.relative.expression.ratio.stats.nofall)
# two-way ANOVA

CFOS_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CFOS.relative.expression.ratio.stats)
summary(CFOS_liver_twoway_anova_results)
Anova(CFOS_liver_twoway_anova_results)
plot(CFOS_liver_twoway_anova_results)

CFOS_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CFOS.relative.expression.ratio.stats.nofall)
summary(CFOS_liver_twoway_anova_rank)
Anova(CFOS_liver_twoway_anova_rank)
plot(CFOS_liver_twoway_anova_rank)

CFOS_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CFOS.relative.expression.ratio.r1hrmix)
eta_squared(CFOS_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CFOS_liver_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CFOS_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CFOS.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CFOS.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CFOS.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CFOS_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CFOS_liver_twoway_anova_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CFOS.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CFOS.liver.boxplot <- ggplot(CFOS.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("C-FOS - Liver")

print(CFOS.liver.boxplot)

### Gill -------------------------------------------------------------------
CFOS.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("C-FOS", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$cfos %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CFOS.Gill)

CFOS.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("C-FOS", "18s"))
         
View(CFOS.Gill)

CFOS.Gill.averaged <- CFOS.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "2G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "3G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "4G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "5G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "6G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "7G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "8G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "9G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "10G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "11G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "12G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "13G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "14G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "15G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "16G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "17G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "18G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "19G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "20G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "21G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "22G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "23G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "24G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "25G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "26G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "27G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "28G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "29G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "30G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "31G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "32G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "33G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "34G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "35G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "36G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "37G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "38G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "39G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "40G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "41G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "42G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "43G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "44G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "45G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "46G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "47G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "48G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "49G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "50G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "51G" & EvaGreen.Name == "C-FOS" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "52G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "53G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "54G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "55G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "56G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "57G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "58G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "59G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "60G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "61G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "62G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "63G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "64G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "65G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "66G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "67G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "68G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "69G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "70G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "71G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "72G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "73G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "74G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "75G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "76G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"],
    Sample.Name == "77G" & EvaGreen.Name == "C-FOS"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="C-FOS"])) 
View(CFOS.Gill.averaged)
## Control Average
CFOS.Control <- CFOS.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CFOS.Control

## Relative Gene Expression 
CFOS.Gill.averaged.delta.ct <- CFOS.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "C-FOS" ~ CFOS.Control$control.average.ct[CFOS.Control$EvaGreen.Name=="C-FOS"],
    EvaGreen.Name == "18s" ~ CFOS.Control$control.average.ct[CFOS.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CFOS.gene.expression.ratio <- CFOS.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="C-FOS"]^delta.ct[EvaGreen.Name=="C-FOS"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "C-FOS")

View(CFOS.gene.expression.ratio)

CFOS.Gill.results <- CFOS.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CFOS.Gill.results)

CFOS.relative.expression.ratio <- CFOS.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CFOS.Gill.results$average.gene.expression[CFOS.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CFOS.Gill.relative.results <- CFOS.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CFOS.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CFOS.relative.expression.ratio.stats <- CFOS.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(CFOS.relative.expression.ratio.stats)


# two-way ANOVA

CFOS_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CFOS.relative.expression.ratio.stats)
summary(CFOS_Gill_twoway_anova_results)
Anova(CFOS_Gill_twoway_anova_results)
plot(CFOS_Gill_twoway_anova_results)

CFOS_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CFOS.relative.expression.ratio.stats)
summary(CFOS_Gill_twoway_anova_rank)
Anova(CFOS_Gill_twoway_anova_rank)
plot(CFOS_Gill_twoway_anova_rank)

CFOS_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CFOS.relative.expression.ratio.r1hrmix)
eta_squared(CFOS_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CFOS_Gill_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CFOS_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CFOS.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CFOS.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CFOS.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CFOS_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CFOS_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CFOS.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CFOS.Gill.boxplot <- ggplot(CFOS.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("C-FOS - Gill")

print(CFOS.Gill.boxplot)

###report stats------------------------------------

CFOS_gill_stats <- CFOS.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(CFOS_gill_stats)

## CYP3A137 -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
CYP3A137.liver <- liver %>%
  filter(EvaGreen.Name %in% c("CYP3A137", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$cyp3 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CYP3A137.liver)

CYP3A137.liver <- liver %>%
  filter(EvaGreen.Name %in% c("CYP3A137", "18s"))
         
View(CYP3A137.liver)

CYP3A137.liver.averaged <- CYP3A137.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "2L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "3L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "4L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "5L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "6L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "7L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "8L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "9L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "10L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "11L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "12L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "13L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "14L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "15L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "16L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "17L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "18L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "19L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "20L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "21L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "22L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "23L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "24L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "25L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "26L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "27L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "28L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "29L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "30L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "31L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "32L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "33L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "34L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "35L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "36L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "37L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "38L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "39L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "40L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "41L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "42L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "43L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "44L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "45L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "46L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "47L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "48L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "49L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "50L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "51L" & EvaGreen.Name == "CYP3A137" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "52L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "53L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "54L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "55L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "56L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "57L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "58L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "59L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "60L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "61L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "62L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "63L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "64L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "65L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "66L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "67L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "68L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "69L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "70L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "71L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "72L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "73L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "74L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "75L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "76L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"],
    Sample.Name == "77L" & EvaGreen.Name == "CYP3A137"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP3A137"])) 
View(CYP3A137.liver.averaged)
## Control Average
CYP3A137.Control <- CYP3A137.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CYP3A137.Control

## Relative Gene Expression 
CYP3A137.liver.averaged.delta.ct <- CYP3A137.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "CYP3A137" ~ CYP3A137.Control$control.average.ct[CYP3A137.Control$EvaGreen.Name=="CYP3A137"],
    EvaGreen.Name == "18s" ~ CYP3A137.Control$control.average.ct[CYP3A137.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CYP3A137.gene.expression.ratio <- CYP3A137.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="CYP3A137"]^delta.ct[EvaGreen.Name=="CYP3A137"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "CYP3A137")

View(CYP3A137.gene.expression.ratio)

CYP3A137.liver.results <- CYP3A137.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CYP3A137.liver.results)

CYP3A137.relative.expression.ratio <- CYP3A137.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CYP3A137.liver.results$average.gene.expression[CYP3A137.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CYP3A137.liver.relative.results <- CYP3A137.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CYP3A137.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CYP3A137.relative.expression.ratio.stats <- CYP3A137.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(CYP3A137.relative.expression.ratio.stats)

CYP3A137.relative.expression.ratio.stats.nofall <- CYP3A137.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(CYP3A137.relative.expression.ratio.stats.nofall)
# two-way ANOVA

CYP3A137_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CYP3A137.relative.expression.ratio.stats)
summary(CYP3A137_liver_twoway_anova_results)
Anova(CYP3A137_liver_twoway_anova_results)
plot(CYP3A137_liver_twoway_anova_results)

CYP3A137_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CYP3A137.relative.expression.ratio.stats)
summary(CYP3A137_liver_twoway_anova_rank)
Anova(CYP3A137_liver_twoway_anova_rank)
plot(CYP3A137_liver_twoway_anova_rank)

CYP3A137_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CYP3A137.relative.expression.ratio.r1hrmix)
eta_squared(CYP3A137_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CYP3A137_liver_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CYP3A137_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CYP3A137.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CYP3A137.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CYP3A137.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CYP3A137_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CYP3A137_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CYP3A137.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CYP3A137.liver.boxplot <- ggplot(CYP3A137.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("CYP3A137 - Liver")

print(CYP3A137.liver.boxplot)

###report stats------------------------------------

CYP3A137_liver_stats <- CYP3A137.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(CYP3A137_liver_stats)

### Gill -------------------------------------------------------------------
CYP3A137.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("CYP3A137", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$cyp3 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CYP3A137.Gill)

CYP3A137.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("CYP3A137", "18s"))
        
         
View(CYP3A137.Gill)

CYP3A137.Gill.averaged <- CYP3A137.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "2G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "3G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "4G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "5G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "6G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "7G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "8G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "9G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "10G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "11G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "12G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "13G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "14G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "15G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "16G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "17G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "18G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "19G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "20G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "21G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "22G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "23G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "24G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "25G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "26G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "27G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "28G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "29G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "30G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "31G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "32G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "33G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "34G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "35G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "36G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "37G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "38G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "39G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "40G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "41G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "42G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "43G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "44G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "45G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "46G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "47G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "48G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "49G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "50G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "51G" & EvaGreen.Name == "CYP3A137" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "52G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "53G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "54G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "55G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "56G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "57G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "58G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "59G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "60G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "61G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "62G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "63G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "64G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "65G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "66G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "67G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "68G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "69G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "70G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "71G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "72G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "73G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "74G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "75G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "76G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"],
    Sample.Name == "77G" & EvaGreen.Name == "CYP3A137"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP3A137"])) 
View(CYP3A137.Gill.averaged)
## Control Average
CYP3A137.Control <- CYP3A137.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CYP3A137.Control

## Relative Gene Expression 
CYP3A137.Gill.averaged.delta.ct <- CYP3A137.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "CYP3A137" ~ CYP3A137.Control$control.average.ct[CYP3A137.Control$EvaGreen.Name=="CYP3A137"],
    EvaGreen.Name == "18s" ~ CYP3A137.Control$control.average.ct[CYP3A137.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CYP3A137.gene.expression.ratio <- CYP3A137.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="CYP3A137"]^delta.ct[EvaGreen.Name=="CYP3A137"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "CYP3A137")

View(CYP3A137.gene.expression.ratio)

CYP3A137.Gill.results <- CYP3A137.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CYP3A137.Gill.results)

CYP3A137.relative.expression.ratio <- CYP3A137.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CYP3A137.Gill.results$average.gene.expression[CYP3A137.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CYP3A137.Gill.relative.results <- CYP3A137.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CYP3A137.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CYP3A137.relative.expression.ratio.stats <- CYP3A137.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(CYP3A137.relative.expression.ratio.stats)


# two-way ANOVA

CYP3A137_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CYP3A137.relative.expression.ratio.stats)
summary(CYP3A137_Gill_twoway_anova_results)
Anova(CYP3A137_Gill_twoway_anova_results)
plot(CYP3A137_Gill_twoway_anova_results)

CYP3A137_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CYP3A137.relative.expression.ratio.stats)
summary(CYP3A137_Gill_twoway_anova_rank)
Anova(CYP3A137_Gill_twoway_anova_rank)
plot(CYP3A137_Gill_twoway_anova_rank)

CYP3A137_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CYP3A137.relative.expression.ratio.r1hrmix)
eta_squared(CYP3A137_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CYP3A137_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CYP3A137_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CYP3A137.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CYP3A137.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CYP3A137.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CYP3A137_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CYP3A137_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CYP3A137.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CYP3A137.Gill.boxplot <- ggplot(CYP3A137.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("CYP3A137 - Gill")

print(CYP3A137.Gill.boxplot)

###report stats------------------------------------

CYP3A137_gill_stats <- CYP3A137.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(CYP3A137_gill_stats)

## GST -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
GST.liver <- liver %>%
  filter(EvaGreen.Name %in% c("GST", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$gst %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(GST.liver)

GST.liver <- liver %>%
  filter(EvaGreen.Name %in% c("GST", "18s"))
         
View(GST.liver)

GST.liver.averaged <- GST.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "2L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "3L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "4L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "5L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "6L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "7L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "8L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "9L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "10L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "11L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "12L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "13L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "14L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "15L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "16L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "17L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "18L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "19L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "20L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "21L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "22L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "23L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "24L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "25L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "26L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "27L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "28L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "29L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "30L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "31L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "32L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "33L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "34L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "35L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "36L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "37L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "38L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "39L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "40L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "41L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "42L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "43L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "44L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "45L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "46L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "47L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "48L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "49L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "50L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "51L" & EvaGreen.Name == "GST" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "52L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "53L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "54L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "55L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "56L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "57L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "58L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "59L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "60L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "61L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "62L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "63L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "64L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "65L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "66L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "67L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "68L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "69L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "70L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "71L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "72L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "73L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "74L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "75L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "76L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"],
    Sample.Name == "77L" & EvaGreen.Name == "GST"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="GST"])) 
View(GST.liver.averaged)
## Control Average
GST.Control <- GST.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

GST.Control

## Relative Gene Expression 
GST.liver.averaged.delta.ct <- GST.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "GST" ~ GST.Control$control.average.ct[GST.Control$EvaGreen.Name=="GST"],
    EvaGreen.Name == "18s" ~ GST.Control$control.average.ct[GST.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

GST.gene.expression.ratio <- GST.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="GST"]^delta.ct[EvaGreen.Name=="GST"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "GST")

View(GST.gene.expression.ratio)

GST.liver.results <- GST.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(GST.liver.results)

GST.relative.expression.ratio <- GST.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = GST.liver.results$average.gene.expression[GST.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

GST.liver.relative.results <- GST.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
GST.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

GST.relative.expression.ratio.stats <- GST.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(GST.relative.expression.ratio.stats)

GST.relative.expression.ratio.stats.nofall <- GST.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(GST.relative.expression.ratio.stats.nofall)
# two-way ANOVA

GST_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = GST.relative.expression.ratio.stats)
summary(GST_liver_twoway_anova_results)
Anova(GST_liver_twoway_anova_results)
plot(GST_liver_twoway_anova_results)

GST_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = GST.relative.expression.ratio.stats)
summary(GST_liver_twoway_anova_rank)
Anova(GST_liver_twoway_anova_rank)
plot(GST_liver_twoway_anova_rank)

GST_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = GST.relative.expression.ratio.r1hrmix)
eta_squared(GST_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(GST_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(GST_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = GST.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=GST.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=GST.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(GST_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(GST_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- GST.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


GST.liver.boxplot <- ggplot(GST.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("GST - Liver")

print(GST.liver.boxplot)

###report stats------------------------------------

GST_liver_stats <- GST.relative.expression.ratio.stats.nofall %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(GST_liver_stats)

### Gill -------------------------------------------------------------------
GST.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("GST", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$gst %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(GST.Gill)

GST.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("GST", "18s"))
         
View(GST.Gill)

GST.Gill.averaged <- GST.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "2G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "3G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "4G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "5G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "6G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "7G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "8G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "9G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "10G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "11G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "12G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "13G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "14G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "15G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "16G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "17G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "18G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "19G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "20G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "21G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "22G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "23G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "24G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "25G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "26G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "27G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "28G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "29G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "30G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "31G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "32G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "33G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "34G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "35G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "36G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "37G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "38G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "39G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "40G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "41G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "42G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "43G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "44G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "45G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "46G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "47G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "48G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "49G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "50G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "51G" & EvaGreen.Name == "GST" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "52G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "53G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "54G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "55G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "56G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "57G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "58G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "59G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "60G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "61G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "62G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "63G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "64G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "65G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "66G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "67G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "68G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "69G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "70G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "71G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "72G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "73G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "74G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "75G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "76G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"],
    Sample.Name == "77G" & EvaGreen.Name == "GST"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="GST"])) 
View(GST.Gill.averaged)
## Control Average
GST.Control <- GST.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

GST.Control

## Relative Gene Expression 
GST.Gill.averaged.delta.ct <- GST.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "GST" ~ GST.Control$control.average.ct[GST.Control$EvaGreen.Name=="GST"],
    EvaGreen.Name == "18s" ~ GST.Control$control.average.ct[GST.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

GST.gene.expression.ratio <- GST.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="GST"]^delta.ct[EvaGreen.Name=="GST"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "GST")

View(GST.gene.expression.ratio)

GST.Gill.results <- GST.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(GST.Gill.results)

GST.relative.expression.ratio <- GST.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = GST.Gill.results$average.gene.expression[GST.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

GST.Gill.relative.results <- GST.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
GST.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

GST.relative.expression.ratio.stats <- GST.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(GST.relative.expression.ratio.stats)


# two-way ANOVA

GST_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = GST.relative.expression.ratio.stats)
summary(GST_Gill_twoway_anova_results)
Anova(GST_Gill_twoway_anova_results)
plot(GST_Gill_twoway_anova_results)

GST_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = GST.relative.expression.ratio.stats)
summary(GST_Gill_twoway_anova_rank)
Anova(GST_Gill_twoway_anova_rank)
plot(GST_Gill_twoway_anova_rank)

GST_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = GST.relative.expression.ratio.r1hrmix)
eta_squared(GST_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(GST_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(GST_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = GST.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=GST.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=GST.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(GST_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(GST_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- GST.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


GST.Gill.boxplot <- ggplot(GST.relative.expression.ratio.stats, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("GST - Gill")

print(GST.Gill.boxplot)

###report stats------------------------------------

GST_gill_stats <- GST.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(GST_gill_stats)

## CYP1A -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
CYP1A.liver <- liver %>%
  filter(EvaGreen.Name %in% c("CYP1A", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$cyp1 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CYP1A.liver)

CYP1A.liver <- liver %>%
  filter(EvaGreen.Name %in% c("CYP1A", "18s"))
         
View(CYP1A.liver)

CYP1A.liver.averaged <- CYP1A.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "2L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "3L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "4L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "5L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "6L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "7L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "8L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "9L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "10L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "11L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "12L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "13L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "14L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "15L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "16L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "17L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "18L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "19L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "20L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "21L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "22L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "23L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "24L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "25L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "26L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "27L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "28L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "29L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "30L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "31L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "32L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "33L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "34L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "35L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "36L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "37L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "38L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "39L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "40L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "41L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "42L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "43L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "44L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "45L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "46L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "47L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "48L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "49L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "50L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "51L" & EvaGreen.Name == "CYP1A" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "52L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "53L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "54L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "55L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "56L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "57L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "58L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "59L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "60L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "61L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "62L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "63L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "64L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "65L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "66L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "67L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "68L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "69L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "70L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "71L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "72L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "73L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "74L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "75L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "76L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"],
    Sample.Name == "77L" & EvaGreen.Name == "CYP1A"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="CYP1A"])) 
View(CYP1A.liver.averaged)
## Control Average
CYP1A.Control <- CYP1A.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CYP1A.Control

## Relative Gene Expression 
CYP1A.liver.averaged.delta.ct <- CYP1A.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "CYP1A" ~ CYP1A.Control$control.average.ct[CYP1A.Control$EvaGreen.Name=="CYP1A"],
    EvaGreen.Name == "18s" ~ CYP1A.Control$control.average.ct[CYP1A.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CYP1A.gene.expression.ratio <- CYP1A.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="CYP1A"]^delta.ct[EvaGreen.Name=="CYP1A"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "CYP1A")

View(CYP1A.gene.expression.ratio)

CYP1A.liver.results <- CYP1A.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CYP1A.liver.results)

CYP1A.relative.expression.ratio <- CYP1A.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CYP1A.liver.results$average.gene.expression[CYP1A.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CYP1A.liver.relative.results <- CYP1A.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CYP1A.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CYP1A.relative.expression.ratio.stats <- CYP1A.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(CYP1A.relative.expression.ratio.stats)

CYP1A.relative.expression.ratio.stats.nofall <- CYP1A.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(CYP1A.relative.expression.ratio.stats.nofall)
# two-way ANOVA

CYP1A_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CYP1A.relative.expression.ratio.stats)
summary(CYP1A_liver_twoway_anova_results)
Anova(CYP1A_liver_twoway_anova_results)
plot(CYP1A_liver_twoway_anova_results)

CYP1A_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CYP1A.relative.expression.ratio.stats)
summary(CYP1A_liver_twoway_anova_rank)
Anova(CYP1A_liver_twoway_anova_rank)
plot(CYP1A_liver_twoway_anova_rank)

CYP1A_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CYP1A.relative.expression.ratio.r1hrmix)
eta_squared(CYP1A_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CYP1A_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CYP1A_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CYP1A.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CYP1A.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CYP1A.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CYP1A_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CYP1A_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CYP1A.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CYP1A.liver.boxplot <- ggplot(CYP1A.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("CYP1A - Liver")

print(CYP1A.liver.boxplot)

### Gill -------------------------------------------------------------------
CYP1A.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("CYP1A", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$cyp1 %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(CYP1A.Gill)

CYP1A.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("CYP1A", "18s"))
        
View(CYP1A.Gill)

CYP1A.Gill.averaged <- CYP1A.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "2G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "3G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "4G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "5G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "6G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "7G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "8G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "9G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "10G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "11G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "12G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "13G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "14G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "15G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "16G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "17G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "18G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "19G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "20G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "21G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "22G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "23G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "24G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "25G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "26G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "27G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "28G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "29G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "30G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "31G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "32G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "33G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "34G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "35G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "36G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "37G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "38G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "39G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "40G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "41G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "42G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "43G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "44G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "45G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "46G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "47G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "48G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "49G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "50G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "51G" & EvaGreen.Name == "CYP1A" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "52G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "53G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "54G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "55G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "56G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "57G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "58G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "59G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "60G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "61G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "62G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "63G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "64G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "65G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "66G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "67G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "68G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "69G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "70G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "71G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "72G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "73G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "74G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "75G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "76G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"],
    Sample.Name == "77G" & EvaGreen.Name == "CYP1A"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="CYP1A"])) 
View(CYP1A.Gill.averaged)
## Control Average
CYP1A.Control <- CYP1A.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

CYP1A.Control

## Relative Gene Expression 
CYP1A.Gill.averaged.delta.ct <- CYP1A.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "CYP1A" ~ CYP1A.Control$control.average.ct[CYP1A.Control$EvaGreen.Name=="CYP1A"],
    EvaGreen.Name == "18s" ~ CYP1A.Control$control.average.ct[CYP1A.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

CYP1A.gene.expression.ratio <- CYP1A.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="CYP1A"]^delta.ct[EvaGreen.Name=="CYP1A"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "CYP1A")

View(CYP1A.gene.expression.ratio)

CYP1A.Gill.results <- CYP1A.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(CYP1A.Gill.results)

CYP1A.relative.expression.ratio <- CYP1A.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = CYP1A.Gill.results$average.gene.expression[CYP1A.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

CYP1A.Gill.relative.results <- CYP1A.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
CYP1A.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

CYP1A.relative.expression.ratio.stats <- CYP1A.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(CYP1A.relative.expression.ratio.stats)


# two-way ANOVA

CYP1A_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = CYP1A.relative.expression.ratio.stats)
summary(CYP1A_Gill_twoway_anova_results)
Anova(CYP1A_Gill_twoway_anova_results)
plot(CYP1A_Gill_twoway_anova_results)

CYP1A_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = CYP1A.relative.expression.ratio.stats)
summary(CYP1A_Gill_twoway_anova_rank)
Anova(CYP1A_Gill_twoway_anova_rank)
plot(CYP1A_Gill_twoway_anova_rank)

CYP1A_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = CYP1A.relative.expression.ratio.r1hrmix)
eta_squared(CYP1A_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(CYP1A_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(CYP1A_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = CYP1A.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=CYP1A.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=CYP1A.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(CYP1A_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(CYP1A_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

###report stats------------------------------------
CYP1A.gill.relative.results.stats <- CYP1A.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )


log2(CYP1A.gill.relative.results.stats$average.relative.expression)

CYP1A_gill_stats <- CYP1A.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View((CYP1A_gill_stats))
log2(CYP1A_gill_stats$mean)
#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- CYP1A.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


CYP1A.Gill.boxplot <- ggplot(CYP1A.relative.expression.ratio.stats, aes(y=log2(relative.expression), x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("CYP1A - Gill")

print(CYP1A.Gill.boxplot)

## IGF1 -------------------------------------------------------------------

### Liver -------------------------------------------------------------------
IGF1.liver <- liver %>%
  filter(EvaGreen.Name %in% c("IGF-1", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$igf %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(IGF1.liver)

IGF1.liver <- liver %>%
  filter(EvaGreen.Name %in% c("IGF-1", "18s"))
         
View(IGF1.liver)

IGF1.liver.averaged <- IGF1.liver %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1L" ~ "Starved_Rock_Spring",
      Sample.Name == "2L" ~ "Starved_Rock_Spring",
      Sample.Name == "3L" ~ "Starved_Rock_Spring",
      Sample.Name == "4L" ~ "Starved_Rock_Spring",
      Sample.Name == "5L" ~ "Starved_Rock_Spring",
      Sample.Name == "6L" ~ "Starved_Rock_Spring",
      Sample.Name == "7L" ~ "Starved_Rock_Spring",
      Sample.Name == "8L" ~ "Starved_Rock_Spring",
      Sample.Name == "9L" ~ "Starved_Rock_Spring",
      Sample.Name == "10L" ~ "Starved_Rock_Spring",
      Sample.Name == "11L" ~ "La_Grange_Spring",
      Sample.Name == "12L" ~ "La_Grange_Spring",
      Sample.Name == "13L" ~ "La_Grange_Spring",
      Sample.Name == "14L" ~ "La_Grange_Spring",
      Sample.Name == "15L" ~ "La_Grange_Spring",
      Sample.Name == "16L" ~ "La_Grange_Spring",
      Sample.Name == "17L" ~ "La_Grange_Spring",
      Sample.Name == "18L" ~ "La_Grange_Spring",
      Sample.Name == "19L" ~ "La_Grange_Spring",
      Sample.Name == "20L" ~ "La_Grange_Spring",
      Sample.Name == "21L" ~ "Dresden_Island_Spring",
      Sample.Name == "22L" ~ "Dresden_Island_Spring",
      Sample.Name == "23L" ~ "Dresden_Island_Summer",
      Sample.Name == "24L" ~ "Dresden_Island_Summer",
      Sample.Name == "25L" ~ "Dresden_Island_Summer",
      Sample.Name == "26L" ~ "Dresden_Island_Summer",
      Sample.Name == "27L" ~ "Dresden_Island_Summer",
      Sample.Name == "28L" ~ "Dresden_Island_Summer",
      Sample.Name == "29L" ~ "Dresden_Island_Summer",
      Sample.Name == "30L" ~ "Dresden_Island_Summer",
      Sample.Name == "31L" ~ "Dresden_Island_Summer",
      Sample.Name == "32L" ~ "Dresden_Island_Summer",
      Sample.Name == "33L" ~ "Starved_Rock_Summer",
      Sample.Name == "34L" ~ "Starved_Rock_Summer",
      Sample.Name == "35L" ~ "Starved_Rock_Summer",
      Sample.Name == "36L" ~ "Starved_Rock_Summer",
      Sample.Name == "37L" ~ "Starved_Rock_Summer",
      Sample.Name == "38L" ~ "Starved_Rock_Summer",
      Sample.Name == "39L" ~ "Starved_Rock_Summer",
      Sample.Name == "40L" ~ "Starved_Rock_Summer",
      Sample.Name == "41L" ~ "Starved_Rock_Summer",
      Sample.Name == "42L" ~ "Starved_Rock_Summer",
      Sample.Name == "43L" ~ "La_Grange_Summer",
      Sample.Name == "44L" ~ "La_Grange_Summer", 
      Sample.Name == "45L" ~ "La_Grange_Summer",
      Sample.Name == "46L" ~ "La_Grange_Summer",
      Sample.Name == "47L" ~ "La_Grange_Summer",
      Sample.Name == "48L" ~ "La_Grange_Summer",
      Sample.Name == "49L" ~ "La_Grange_Summer",
      Sample.Name == "50L" ~ "La_Grange_Summer",
      Sample.Name == "51L" ~ "La_Grange_Summer",
      Sample.Name == "52L" ~ "La_Grange_Summer",
      Sample.Name == "53L" ~ "La_Grange_Fall",
      Sample.Name == "54L" ~ "La_Grange_Fall",
      Sample.Name == "55L" ~ "La_Grange_Fall",
      Sample.Name == "56L" ~ "La_Grange_Fall",
      Sample.Name == "57L" ~ "La_Grange_Fall",
      Sample.Name == "58L" ~ "La_Grange_Fall",
      Sample.Name == "59L" ~ "La_Grange_Fall",
      Sample.Name == "60L" ~ "La_Grange_Fall",
      Sample.Name == "61L" ~ "La_Grange_Fall",
      Sample.Name == "62L" ~ "La_Grange_Fall",
      Sample.Name == "63L" ~ "Starved_Rock_Fall",
      Sample.Name == "64L" ~ "Starved_Rock_Fall",
      Sample.Name == "65L" ~ "Starved_Rock_Fall",
      Sample.Name == "66L" ~ "Starved_Rock_Fall",
      Sample.Name == "67L" ~ "Starved_Rock_Fall",
      Sample.Name == "68L" ~ "Starved_Rock_Fall",
      Sample.Name == "69L" ~ "Starved_Rock_Fall",
      Sample.Name == "70L" ~ "Starved_Rock_Fall",
      Sample.Name == "71L" ~ "Starved_Rock_Fall",
      Sample.Name == "72L" ~ "Starved_Rock_Fall",
      Sample.Name == "73L" ~ "Dresden_Island_Fall",
      Sample.Name == "74L" ~ "Dresden_Island_Fall",
      Sample.Name == "75L" ~ "Dresden_Island_Fall",
      Sample.Name == "76L" ~ "Dresden_Island_Fall",
      Sample.Name == "77L" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "2L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "3L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "4L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "5L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "6L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "7L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "8L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "9L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "10L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "11L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "12L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "13L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "14L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "15L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "16L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "17L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "18L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "19L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "20L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "21L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "22L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "23L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "24L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "25L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "26L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "27L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "28L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "29L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "30L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "31L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "32L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "33L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "34L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "35L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "36L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "37L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "38L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "39L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "40L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "41L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "42L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "43L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "44L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "45L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "46L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "47L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "48L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "49L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "50L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "51L" & EvaGreen.Name == "18s" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "52L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "53L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "54L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "55L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "56L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "57L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "58L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "59L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "60L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "61L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "62L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "63L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "64L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "65L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "66L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "67L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "68L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "69L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "70L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "71L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "72L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "73L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "74L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "75L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "76L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "77L" & EvaGreen.Name == "18s"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="18s"],
    Sample.Name == "1L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "2L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "3L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "4L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "5L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "6L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "7L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "8L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "9L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "10L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "11L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "12L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "13L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "14L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "15L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "16L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "17L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "18L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "19L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "20L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "21L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "22L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "23L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "24L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "25L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "26L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "27L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "28L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "29L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "30L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "31L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "32L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "33L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "34L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "35L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "36L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "37L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "38L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "39L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "40L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "41L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "42L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "43L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "44L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "45L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "46L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "47L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "48L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "49L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "50L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "51L" & EvaGreen.Name == "IGF-1" ~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "52L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "53L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "54L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "55L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "56L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "57L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "58L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "59L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "60L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "61L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "62L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "63L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "64L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "65L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "66L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "67L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "68L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "69L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "70L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "71L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "72L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "73L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "74L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "75L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "76L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"],
    Sample.Name == "77L" & EvaGreen.Name == "IGF-1"~ slope.plate1$slope.efficiency[slope.plate1$Gene=="IGF-1"])) 
View(IGF1.liver.averaged)
## Control Average
IGF1.Control <- IGF1.liver.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

IGF1.Control

## Relative Gene Expression 
IGF1.liver.averaged.delta.ct <- IGF1.liver.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "IGF-1" ~ IGF1.Control$control.average.ct[IGF1.Control$EvaGreen.Name=="IGF-1"],
    EvaGreen.Name == "18s" ~ IGF1.Control$control.average.ct[IGF1.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

IGF1.gene.expression.ratio <- IGF1.liver.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="IGF-1"]^delta.ct[EvaGreen.Name=="IGF-1"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "IGF-1")

View(IGF1.gene.expression.ratio)

IGF1.liver.results <- IGF1.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(IGF1.liver.results)

IGF1.relative.expression.ratio <- IGF1.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = IGF1.liver.results$average.gene.expression[IGF1.liver.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

IGF1.liver.relative.results <- IGF1.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
IGF1.liver.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

IGF1.relative.expression.ratio.stats <- IGF1.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1L" ~ "Starved_Rock",
      Sample.Name == "2L" ~ "Starved_Rock",
      Sample.Name == "3L" ~ "Starved_Rock",
      Sample.Name == "4L" ~ "Starved_Rock",
      Sample.Name == "5L" ~ "Starved_Rock",
      Sample.Name == "6L" ~ "Starved_Rock",
      Sample.Name == "7L" ~ "Starved_Rock",
      Sample.Name == "8L" ~ "Starved_Rock",
      Sample.Name == "9L" ~ "Starved_Rock",
      Sample.Name == "10L" ~ "Starved_Rock",
      Sample.Name == "11L" ~ "La_Grange",
      Sample.Name == "12L" ~ "La_Grange",
      Sample.Name == "13L" ~ "La_Grange",
      Sample.Name == "14L" ~ "La_Grange",
      Sample.Name == "15L" ~ "La_Grange",
      Sample.Name == "16L" ~ "La_Grange",
      Sample.Name == "17L" ~ "La_Grange",
      Sample.Name == "18L" ~ "La_Grange",
      Sample.Name == "19L" ~ "La_Grange",
      Sample.Name == "20L" ~ "La_Grange",
      Sample.Name == "21L" ~ "Dresden_Island",
      Sample.Name == "22L" ~ "Dresden_Island",
      Sample.Name == "23L" ~ "Dresden_Island",
      Sample.Name == "24L" ~ "Dresden_Island",
      Sample.Name == "25L" ~ "Dresden_Island",
      Sample.Name == "26L" ~ "Dresden_Island",
      Sample.Name == "27L" ~ "Dresden_Island",
      Sample.Name == "28L" ~ "Dresden_Island",
      Sample.Name == "29L" ~ "Dresden_Island",
      Sample.Name == "30L" ~ "Dresden_Island",
      Sample.Name == "31L" ~ "Dresden_Island",
      Sample.Name == "32L" ~ "Dresden_Island",
      Sample.Name == "33L" ~ "Starved_Rock",
      Sample.Name == "34L" ~ "Starved_Rock",
      Sample.Name == "35L" ~ "Starved_Rock",
      Sample.Name == "36L" ~ "Starved_Rock",
      Sample.Name == "37L" ~ "Starved_Rock",
      Sample.Name == "38L" ~ "Starved_Rock",
      Sample.Name == "39L" ~ "Starved_Rock",
      Sample.Name == "40L" ~ "Starved_Rock",
      Sample.Name == "41L" ~ "Starved_Rock",
      Sample.Name == "42L" ~ "Starved_Rock",
      Sample.Name == "43L" ~ "La_Grange",
      Sample.Name == "44L" ~ "La_Grange", 
      Sample.Name == "45L" ~ "La_Grange",
      Sample.Name == "46L" ~ "La_Grange",
      Sample.Name == "47L" ~ "La_Grange",
      Sample.Name == "48L" ~ "La_Grange",
      Sample.Name == "49L" ~ "La_Grange",
      Sample.Name == "50L" ~ "La_Grange",
      Sample.Name == "51L" ~ "La_Grange",
      Sample.Name == "52L" ~ "La_Grange",
      Sample.Name == "53L" ~ "La_Grange",
      Sample.Name == "54L" ~ "La_Grange",
      Sample.Name == "55L" ~ "La_Grange",
      Sample.Name == "56L" ~ "La_Grange",
      Sample.Name == "57L" ~ "La_Grange",
      Sample.Name == "58L" ~ "La_Grange",
      Sample.Name == "59L" ~ "La_Grange",
      Sample.Name == "60L" ~ "La_Grange",
      Sample.Name == "61L" ~ "La_Grange",
      Sample.Name == "62L" ~ "La_Grange",
      Sample.Name == "63L" ~ "Starved_Rock",
      Sample.Name == "64L" ~ "Starved_Rock",
      Sample.Name == "65L" ~ "Starved_Rock",
      Sample.Name == "66L" ~ "Starved_Rock",
      Sample.Name == "67L" ~ "Starved_Rock",
      Sample.Name == "68L" ~ "Starved_Rock",
      Sample.Name == "69L" ~ "Starved_Rock",
      Sample.Name == "70L" ~ "Starved_Rock",
      Sample.Name == "71L" ~ "Starved_Rock",
      Sample.Name == "72L" ~ "Starved_Rock",
      Sample.Name == "73L" ~ "Dresden_Island",
      Sample.Name == "74L" ~ "Dresden_Island",
      Sample.Name == "75L" ~ "Dresden_Island",
      Sample.Name == "76L" ~ "Dresden_Island",
      Sample.Name == "77L" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1L" ~ "Spring",
      Sample.Name == "2L" ~ "Spring",
      Sample.Name == "3L" ~ "Spring",
      Sample.Name == "4L" ~ "Spring",
      Sample.Name == "5L" ~ "Spring",
      Sample.Name == "6L" ~ "Spring",
      Sample.Name == "7L" ~ "Spring",
      Sample.Name == "8L" ~ "Spring",
      Sample.Name == "9L" ~ "Spring",
      Sample.Name == "10L" ~ "Spring",
      Sample.Name == "11L" ~ "Spring",
      Sample.Name == "12L" ~ "Spring",
      Sample.Name == "13L" ~ "Spring",
      Sample.Name == "14L" ~ "Spring",
      Sample.Name == "15L" ~ "Spring",
      Sample.Name == "16L" ~ "Spring",
      Sample.Name == "17L" ~ "Spring",
      Sample.Name == "18L" ~ "Spring",
      Sample.Name == "19L" ~ "Spring",
      Sample.Name == "20L" ~ "Spring",
      Sample.Name == "21L" ~ "Spring",
      Sample.Name == "22L" ~ "Spring",
      Sample.Name == "23L" ~ "Summer",
      Sample.Name == "24L" ~ "Summer",
      Sample.Name == "25L" ~ "Summer",
      Sample.Name == "26L" ~ "Summer",
      Sample.Name == "27L" ~ "Summer",
      Sample.Name == "28L" ~ "Summer",
      Sample.Name == "29L" ~ "Summer",
      Sample.Name == "30L" ~ "Summer",
      Sample.Name == "31L" ~ "Summer",
      Sample.Name == "32L" ~ "Summer",
      Sample.Name == "33L" ~ "Summer",
      Sample.Name == "34L" ~ "Summer",
      Sample.Name == "35L" ~ "Summer",
      Sample.Name == "36L" ~ "Summer",
      Sample.Name == "37L" ~ "Summer",
      Sample.Name == "38L" ~ "Summer",
      Sample.Name == "39L" ~ "Summer",
      Sample.Name == "40L" ~ "Summer",
      Sample.Name == "41L" ~ "Summer",
      Sample.Name == "42L" ~ "Summer",
      Sample.Name == "43L" ~ "Summer",
      Sample.Name == "44L" ~ "Summer", 
      Sample.Name == "45L" ~ "Summer",
      Sample.Name == "46L" ~ "Summer",
      Sample.Name == "47L" ~ "Summer",
      Sample.Name == "48L" ~ "Summer",
      Sample.Name == "49L" ~ "Summer",
      Sample.Name == "50L" ~ "Summer",
      Sample.Name == "51L" ~ "Summer",
      Sample.Name == "52L" ~ "Summer",
      Sample.Name == "53L" ~ "Fall",
      Sample.Name == "54L" ~ "Fall",
      Sample.Name == "55L" ~ "Fall",
      Sample.Name == "56L" ~ "Fall",
      Sample.Name == "57L" ~ "Fall",
      Sample.Name == "58L" ~ "Fall",
      Sample.Name == "59L" ~ "Fall",
      Sample.Name == "60L" ~ "Fall",
      Sample.Name == "61L" ~ "Fall",
      Sample.Name == "62L" ~ "Fall",
      Sample.Name == "63L" ~ "Fall",
      Sample.Name == "64L" ~ "Fall",
      Sample.Name == "65L" ~ "Fall",
      Sample.Name == "66L" ~ "Fall",
      Sample.Name == "67L" ~ "Fall",
      Sample.Name == "68L" ~ "Fall",
      Sample.Name == "69L" ~ "Fall",
      Sample.Name == "70L" ~ "Fall",
      Sample.Name == "71L" ~ "Fall",
      Sample.Name == "72L" ~ "Fall",
      Sample.Name == "73L" ~ "Fall",
      Sample.Name == "74L" ~ "Fall",
      Sample.Name == "75L" ~ "Fall",
      Sample.Name == "76L" ~ "Fall",
      Sample.Name == "77L" ~ "Fall")) 

View(IGF1.relative.expression.ratio.stats)

IGF1.relative.expression.ratio.stats.nofall <- IGF1.relative.expression.ratio.stats %>%
  filter(Season != "Fall")

View(IGF1.relative.expression.ratio.stats.nofall)
# two-way ANOVA

IGF1_liver_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = IGF1.relative.expression.ratio.stats)
summary(IGF1_liver_twoway_anova_results)
Anova(IGF1_liver_twoway_anova_results)
plot(IGF1_liver_twoway_anova_results)

IGF1_liver_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = IGF1.relative.expression.ratio.stats)
summary(IGF1_liver_twoway_anova_rank)
Anova(IGF1_liver_twoway_anova_rank)
plot(IGF1_liver_twoway_anova_rank)

IGF1_liver_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = IGF1.relative.expression.ratio.r1hrmix)
eta_squared(IGF1_liver_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(IGF1_liver_twoway_anova_results, ~Pool)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(IGF1_liver_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = IGF1.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=IGF1.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=IGF1.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(IGF1_liver_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(IGF1_liver_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- IGF1.relative.expression.ratio.stats.nofall %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


IGF1.liver.boxplot <- ggplot(IGF1.relative.expression.ratio.stats.nofall, aes(y=relative.expression, x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("IGF-1 - Liver")

print(IGF1.liver.boxplot)

###report stats------------------------------------

IGF1_liver_stats <- IGF1.relative.expression.ratio.stats.nofall %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(IGF1_liver_stats)

### Gill -------------------------------------------------------------------
IGF1.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("IGF-1", "18s"),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$igf %in% c("low expression", "high expression", "no expression")]),
         !(Sample.Name %in% expression_data_outside_curve$Sample_ID[expression_data_outside_curve$rna18 %in% c("low expression", "high expression", "no expression")]))
View(IGF1.Gill)

IGF1.Gill <- gill %>%
  filter(EvaGreen.Name %in% c("IGF-1", "18s"))
        
View(IGF1.Gill)

IGF1.Gill.averaged <- IGF1.Gill %>%
  group_by(Sample.Name, EvaGreen.Name) %>%
  summarize(
    average.ct = mean(Ct.Value,na.rm=T)) %>%
  mutate(
    Treatment = case_when(
      Sample.Name == "1G" ~ "Starved_Rock_Spring",
      Sample.Name == "2G" ~ "Starved_Rock_Spring",
      Sample.Name == "3G" ~ "Starved_Rock_Spring",
      Sample.Name == "4G" ~ "Starved_Rock_Spring",
      Sample.Name == "5G" ~ "Starved_Rock_Spring",
      Sample.Name == "6G" ~ "Starved_Rock_Spring",
      Sample.Name == "7G" ~ "Starved_Rock_Spring",
      Sample.Name == "8G" ~ "Starved_Rock_Spring",
      Sample.Name == "9G" ~ "Starved_Rock_Spring",
      Sample.Name == "10G" ~ "Starved_Rock_Spring",
      Sample.Name == "11G" ~ "La_Grange_Spring",
      Sample.Name == "12G" ~ "La_Grange_Spring",
      Sample.Name == "13G" ~ "La_Grange_Spring",
      Sample.Name == "14G" ~ "La_Grange_Spring",
      Sample.Name == "15G" ~ "La_Grange_Spring",
      Sample.Name == "16G" ~ "La_Grange_Spring",
      Sample.Name == "17G" ~ "La_Grange_Spring",
      Sample.Name == "18G" ~ "La_Grange_Spring",
      Sample.Name == "19G" ~ "La_Grange_Spring",
      Sample.Name == "20G" ~ "La_Grange_Spring",
      Sample.Name == "21G" ~ "Dresden_Island_Spring",
      Sample.Name == "22G" ~ "Dresden_Island_Spring",
      Sample.Name == "23G" ~ "Dresden_Island_Summer",
      Sample.Name == "24G" ~ "Dresden_Island_Summer",
      Sample.Name == "25G" ~ "Dresden_Island_Summer",
      Sample.Name == "26G" ~ "Dresden_Island_Summer",
      Sample.Name == "27G" ~ "Dresden_Island_Summer",
      Sample.Name == "28G" ~ "Dresden_Island_Summer",
      Sample.Name == "29G" ~ "Dresden_Island_Summer",
      Sample.Name == "30G" ~ "Dresden_Island_Summer",
      Sample.Name == "31G" ~ "Dresden_Island_Summer",
      Sample.Name == "32G" ~ "Dresden_Island_Summer",
      Sample.Name == "33G" ~ "Starved_Rock_Summer",
      Sample.Name == "34G" ~ "Starved_Rock_Summer",
      Sample.Name == "35G" ~ "Starved_Rock_Summer",
      Sample.Name == "36G" ~ "Starved_Rock_Summer",
      Sample.Name == "37G" ~ "Starved_Rock_Summer",
      Sample.Name == "38G" ~ "Starved_Rock_Summer",
      Sample.Name == "39G" ~ "Starved_Rock_Summer",
      Sample.Name == "40G" ~ "Starved_Rock_Summer",
      Sample.Name == "41G" ~ "Starved_Rock_Summer",
      Sample.Name == "42G" ~ "Starved_Rock_Summer",
      Sample.Name == "43G" ~ "La_Grange_Summer",
      Sample.Name == "44G" ~ "La_Grange_Summer", 
      Sample.Name == "45G" ~ "La_Grange_Summer",
      Sample.Name == "46G" ~ "La_Grange_Summer",
      Sample.Name == "47G" ~ "La_Grange_Summer",
      Sample.Name == "48G" ~ "La_Grange_Summer",
      Sample.Name == "49G" ~ "La_Grange_Summer",
      Sample.Name == "50G" ~ "La_Grange_Summer",
      Sample.Name == "51G" ~ "La_Grange_Summer",
      Sample.Name == "52G" ~ "La_Grange_Summer",
      Sample.Name == "53G" ~ "La_Grange_Fall",
      Sample.Name == "54G" ~ "La_Grange_Fall",
      Sample.Name == "55G" ~ "La_Grange_Fall",
      Sample.Name == "56G" ~ "La_Grange_Fall",
      Sample.Name == "57G" ~ "La_Grange_Fall",
      Sample.Name == "58G" ~ "La_Grange_Fall",
      Sample.Name == "59G" ~ "La_Grange_Fall",
      Sample.Name == "60G" ~ "La_Grange_Fall",
      Sample.Name == "61G" ~ "La_Grange_Fall",
      Sample.Name == "62G" ~ "La_Grange_Fall",
      Sample.Name == "63G" ~ "Starved_Rock_Fall",
      Sample.Name == "64G" ~ "Starved_Rock_Fall",
      Sample.Name == "65G" ~ "Starved_Rock_Fall",
      Sample.Name == "66G" ~ "Starved_Rock_Fall",
      Sample.Name == "67G" ~ "Starved_Rock_Fall",
      Sample.Name == "68G" ~ "Starved_Rock_Fall",
      Sample.Name == "69G" ~ "Starved_Rock_Fall",
      Sample.Name == "70G" ~ "Starved_Rock_Fall",
      Sample.Name == "71G" ~ "Starved_Rock_Fall",
      Sample.Name == "72G" ~ "Starved_Rock_Fall",
      Sample.Name == "73G" ~ "Dresden_Island_Fall",
      Sample.Name == "74G" ~ "Dresden_Island_Fall",
      Sample.Name == "75G" ~ "Dresden_Island_Fall",
      Sample.Name == "76G" ~ "Dresden_Island_Fall",
      Sample.Name == "77G" ~ "Dresden_Island_Fall")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) %>%
  group_by(Sample.Name) %>%
  filter(n() > 1) %>%
  ungroup() %>%
  mutate (slope.efficiency = case_when(
    Sample.Name == "1G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "2G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "3G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "4G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "5G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "6G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "7G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "8G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "9G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "10G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "11G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "12G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "13G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "14G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "15G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "16G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "17G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "18G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "19G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "20G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "21G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "22G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "23G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "24G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "25G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "26G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "27G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "28G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "29G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "30G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "31G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "32G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "33G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "34G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "35G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "36G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "37G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "38G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "39G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "40G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "41G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "42G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "43G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "44G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "45G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "46G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "47G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "48G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "49G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "50G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "51G" & EvaGreen.Name == "18s" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "52G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "53G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "54G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "55G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "56G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "57G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "58G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "59G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "60G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "61G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "62G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "63G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "64G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "65G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "66G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "67G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "68G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "69G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "70G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "71G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "72G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "73G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "74G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "75G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "76G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "77G" & EvaGreen.Name == "18s"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="18s"],
    Sample.Name == "1G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "2G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "3G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "4G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "5G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "6G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "7G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "8G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "9G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "10G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "11G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "12G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "13G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "14G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "15G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "16G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "17G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "18G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "19G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "20G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "21G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "22G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "23G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "24G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "25G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "26G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "27G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "28G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "29G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "30G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "31G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "32G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "33G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "34G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "35G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "36G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "37G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "38G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "39G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "40G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "41G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "42G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "43G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "44G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "45G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "46G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "47G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "48G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "49G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "50G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "51G" & EvaGreen.Name == "IGF-1" ~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "52G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "53G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "54G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "55G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "56G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "57G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "58G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "59G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "60G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "61G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "62G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "63G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "64G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "65G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "66G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "67G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "68G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "69G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "70G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "71G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "72G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "73G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "74G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "75G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "76G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"],
    Sample.Name == "77G" & EvaGreen.Name == "IGF-1"~ slope.plate2$slope.efficiency[slope.plate2$Gene=="IGF-1"])) 
View(IGF1.Gill.averaged)
## Control Average
IGF1.Control <- IGF1.Gill.averaged %>%
  filter(Treatment == "La_Grange_Spring") %>%
  group_by(EvaGreen.Name) %>%
  summarize(
    control.average.ct = mean(average.ct,na.rm=T)) 

IGF1.Control

## Relative Gene Expression 
IGF1.Gill.averaged.delta.ct <- IGF1.Gill.averaged %>%
  mutate(average.delta.ct = case_when(
    EvaGreen.Name == "IGF-1" ~ IGF1.Control$control.average.ct[IGF1.Control$EvaGreen.Name=="IGF-1"],
    EvaGreen.Name == "18s" ~ IGF1.Control$control.average.ct[IGF1.Control$EvaGreen.Name=="18s"]),
    delta.ct = average.delta.ct - average.ct)

IGF1.gene.expression.ratio <- IGF1.Gill.averaged.delta.ct %>%
  group_by(Sample.Name) %>%
  mutate(gene.expression.ratio = slope.efficiency[EvaGreen.Name=="IGF-1"]^delta.ct[EvaGreen.Name=="IGF-1"] / slope.efficiency[EvaGreen.Name=="18s"]^delta.ct[EvaGreen.Name=="18s"]) %>% 
  filter(EvaGreen.Name == "IGF-1")

View(IGF1.gene.expression.ratio)

IGF1.Gill.results <- IGF1.gene.expression.ratio %>%
  group_by(Treatment, Season) %>%
  summarize(
    average.delta.ct = mean(delta.ct,na.rm=T),
    sd.delta.ct = sd(delta.ct,na.rm=T),
    max.delta.ct = max(delta.ct,na.rm=T),
    min.delta.ct = min(delta.ct,na.rm=T),
    average.gene.expression = mean(gene.expression.ratio,na.rm=T),
    sd.gene.expression = sd(gene.expression.ratio,na.rm=T),
    max.gene.expression = max(gene.expression.ratio,na.rm=T),
    min.gene.expression = min(gene.expression.ratio,na.rm=T),
    individual.fish = n())



View(IGF1.Gill.results)

IGF1.relative.expression.ratio <- IGF1.gene.expression.ratio %>%
  mutate(control.gene.expression.ratio = IGF1.Gill.results$average.gene.expression[IGF1.Gill.results$Treatment=="La_Grange_Spring"],
         relative.expression = gene.expression.ratio / control.gene.expression.ratio)

IGF1.Gill.relative.results <- IGF1.relative.expression.ratio %>%
  group_by(Treatment) %>%
  summarize(
    average.relative.expression = mean(relative.expression,na.rm=T),
    sd.relative.expression = sd(relative.expression,na.rm=T),
    max.relative.expression = max(relative.expression,na.rm=T),
    min.relative.expression = min(relative.expression,na.rm=T),
    individual.fish = n()
  )
IGF1.Gill.relative.results


#### Stats -------------------------------------------------------------------

##### 2way ANOVA  ----------------------------------------------------------

IGF1.relative.expression.ratio.stats <- IGF1.relative.expression.ratio %>%
  mutate(
    Pool = case_when(
      Sample.Name == "1G" ~ "Starved_Rock",
      Sample.Name == "2G" ~ "Starved_Rock",
      Sample.Name == "3G" ~ "Starved_Rock",
      Sample.Name == "4G" ~ "Starved_Rock",
      Sample.Name == "5G" ~ "Starved_Rock",
      Sample.Name == "6G" ~ "Starved_Rock",
      Sample.Name == "7G" ~ "Starved_Rock",
      Sample.Name == "8G" ~ "Starved_Rock",
      Sample.Name == "9G" ~ "Starved_Rock",
      Sample.Name == "10G" ~ "Starved_Rock",
      Sample.Name == "11G" ~ "La_Grange",
      Sample.Name == "12G" ~ "La_Grange",
      Sample.Name == "13G" ~ "La_Grange",
      Sample.Name == "14G" ~ "La_Grange",
      Sample.Name == "15G" ~ "La_Grange",
      Sample.Name == "16G" ~ "La_Grange",
      Sample.Name == "17G" ~ "La_Grange",
      Sample.Name == "18G" ~ "La_Grange",
      Sample.Name == "19G" ~ "La_Grange",
      Sample.Name == "20G" ~ "La_Grange",
      Sample.Name == "21G" ~ "Dresden_Island",
      Sample.Name == "22G" ~ "Dresden_Island",
      Sample.Name == "23G" ~ "Dresden_Island",
      Sample.Name == "24G" ~ "Dresden_Island",
      Sample.Name == "25G" ~ "Dresden_Island",
      Sample.Name == "26G" ~ "Dresden_Island",
      Sample.Name == "27G" ~ "Dresden_Island",
      Sample.Name == "28G" ~ "Dresden_Island",
      Sample.Name == "29G" ~ "Dresden_Island",
      Sample.Name == "30G" ~ "Dresden_Island",
      Sample.Name == "31G" ~ "Dresden_Island",
      Sample.Name == "32G" ~ "Dresden_Island",
      Sample.Name == "33G" ~ "Starved_Rock",
      Sample.Name == "34G" ~ "Starved_Rock",
      Sample.Name == "35G" ~ "Starved_Rock",
      Sample.Name == "36G" ~ "Starved_Rock",
      Sample.Name == "37G" ~ "Starved_Rock",
      Sample.Name == "38G" ~ "Starved_Rock",
      Sample.Name == "39G" ~ "Starved_Rock",
      Sample.Name == "40G" ~ "Starved_Rock",
      Sample.Name == "41G" ~ "Starved_Rock",
      Sample.Name == "42G" ~ "Starved_Rock",
      Sample.Name == "43G" ~ "La_Grange",
      Sample.Name == "44G" ~ "La_Grange", 
      Sample.Name == "45G" ~ "La_Grange",
      Sample.Name == "46G" ~ "La_Grange",
      Sample.Name == "47G" ~ "La_Grange",
      Sample.Name == "48G" ~ "La_Grange",
      Sample.Name == "49G" ~ "La_Grange",
      Sample.Name == "50G" ~ "La_Grange",
      Sample.Name == "51G" ~ "La_Grange",
      Sample.Name == "52G" ~ "La_Grange",
      Sample.Name == "53G" ~ "La_Grange",
      Sample.Name == "54G" ~ "La_Grange",
      Sample.Name == "55G" ~ "La_Grange",
      Sample.Name == "56G" ~ "La_Grange",
      Sample.Name == "57G" ~ "La_Grange",
      Sample.Name == "58G" ~ "La_Grange",
      Sample.Name == "59G" ~ "La_Grange",
      Sample.Name == "60G" ~ "La_Grange",
      Sample.Name == "61G" ~ "La_Grange",
      Sample.Name == "62G" ~ "La_Grange",
      Sample.Name == "63G" ~ "Starved_Rock",
      Sample.Name == "64G" ~ "Starved_Rock",
      Sample.Name == "65G" ~ "Starved_Rock",
      Sample.Name == "66G" ~ "Starved_Rock",
      Sample.Name == "67G" ~ "Starved_Rock",
      Sample.Name == "68G" ~ "Starved_Rock",
      Sample.Name == "69G" ~ "Starved_Rock",
      Sample.Name == "70G" ~ "Starved_Rock",
      Sample.Name == "71G" ~ "Starved_Rock",
      Sample.Name == "72G" ~ "Starved_Rock",
      Sample.Name == "73G" ~ "Dresden_Island",
      Sample.Name == "74G" ~ "Dresden_Island",
      Sample.Name == "75G" ~ "Dresden_Island",
      Sample.Name == "76G" ~ "Dresden_Island",
      Sample.Name == "77G" ~ "Dresden_Island")) %>%
  mutate(
    Season = case_when(
      Sample.Name == "1G" ~ "Spring",
      Sample.Name == "2G" ~ "Spring",
      Sample.Name == "3G" ~ "Spring",
      Sample.Name == "4G" ~ "Spring",
      Sample.Name == "5G" ~ "Spring",
      Sample.Name == "6G" ~ "Spring",
      Sample.Name == "7G" ~ "Spring",
      Sample.Name == "8G" ~ "Spring",
      Sample.Name == "9G" ~ "Spring",
      Sample.Name == "10G" ~ "Spring",
      Sample.Name == "11G" ~ "Spring",
      Sample.Name == "12G" ~ "Spring",
      Sample.Name == "13G" ~ "Spring",
      Sample.Name == "14G" ~ "Spring",
      Sample.Name == "15G" ~ "Spring",
      Sample.Name == "16G" ~ "Spring",
      Sample.Name == "17G" ~ "Spring",
      Sample.Name == "18G" ~ "Spring",
      Sample.Name == "19G" ~ "Spring",
      Sample.Name == "20G" ~ "Spring",
      Sample.Name == "21G" ~ "Spring",
      Sample.Name == "22G" ~ "Spring",
      Sample.Name == "23G" ~ "Summer",
      Sample.Name == "24G" ~ "Summer",
      Sample.Name == "25G" ~ "Summer",
      Sample.Name == "26G" ~ "Summer",
      Sample.Name == "27G" ~ "Summer",
      Sample.Name == "28G" ~ "Summer",
      Sample.Name == "29G" ~ "Summer",
      Sample.Name == "30G" ~ "Summer",
      Sample.Name == "31G" ~ "Summer",
      Sample.Name == "32G" ~ "Summer",
      Sample.Name == "33G" ~ "Summer",
      Sample.Name == "34G" ~ "Summer",
      Sample.Name == "35G" ~ "Summer",
      Sample.Name == "36G" ~ "Summer",
      Sample.Name == "37G" ~ "Summer",
      Sample.Name == "38G" ~ "Summer",
      Sample.Name == "39G" ~ "Summer",
      Sample.Name == "40G" ~ "Summer",
      Sample.Name == "41G" ~ "Summer",
      Sample.Name == "42G" ~ "Summer",
      Sample.Name == "43G" ~ "Summer",
      Sample.Name == "44G" ~ "Summer", 
      Sample.Name == "45G" ~ "Summer",
      Sample.Name == "46G" ~ "Summer",
      Sample.Name == "47G" ~ "Summer",
      Sample.Name == "48G" ~ "Summer",
      Sample.Name == "49G" ~ "Summer",
      Sample.Name == "50G" ~ "Summer",
      Sample.Name == "51G" ~ "Summer",
      Sample.Name == "52G" ~ "Summer",
      Sample.Name == "53G" ~ "Fall",
      Sample.Name == "54G" ~ "Fall",
      Sample.Name == "55G" ~ "Fall",
      Sample.Name == "56G" ~ "Fall",
      Sample.Name == "57G" ~ "Fall",
      Sample.Name == "58G" ~ "Fall",
      Sample.Name == "59G" ~ "Fall",
      Sample.Name == "60G" ~ "Fall",
      Sample.Name == "61G" ~ "Fall",
      Sample.Name == "62G" ~ "Fall",
      Sample.Name == "63G" ~ "Fall",
      Sample.Name == "64G" ~ "Fall",
      Sample.Name == "65G" ~ "Fall",
      Sample.Name == "66G" ~ "Fall",
      Sample.Name == "67G" ~ "Fall",
      Sample.Name == "68G" ~ "Fall",
      Sample.Name == "69G" ~ "Fall",
      Sample.Name == "70G" ~ "Fall",
      Sample.Name == "71G" ~ "Fall",
      Sample.Name == "72G" ~ "Fall",
      Sample.Name == "73G" ~ "Fall",
      Sample.Name == "74G" ~ "Fall",
      Sample.Name == "75G" ~ "Fall",
      Sample.Name == "76G" ~ "Fall",
      Sample.Name == "77G" ~ "Fall")) 

View(IGF1.relative.expression.ratio.stats)


# two-way ANOVA

IGF1_Gill_twoway_anova_results <- aov(log2(relative.expression) ~ Pool*Season, data = IGF1.relative.expression.ratio.stats)
summary(IGF1_Gill_twoway_anova_results)
Anova(IGF1_Gill_twoway_anova_results)
plot(IGF1_Gill_twoway_anova_results)

IGF1_Gill_twoway_anova_rank <- aov(rank(relative.expression) ~ Pool * Season, data = IGF1.relative.expression.ratio.stats)
summary(IGF1_Gill_twoway_anova_rank)
Anova(IGF1_Gill_twoway_anova_rank)
plot(IGF1_Gill_twoway_anova_rank)

IGF1_Gill_twoway_effectsize <- lm(rank(relative.expression) ~ Water * Time, data = IGF1.relative.expression.ratio.r1hrmix)
eta_squared(IGF1_Gill_twoway_effectsize, partial=F)

# Tukey HSD
emmeans_result <- emmeans(IGF1_Gill_twoway_anova_results, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)

emmeans_result <- emmeans(IGF1_Gill_twoway_anova_results_rank, ~Pool*Season)
emmeans_df <- as.data.frame(emmeans_result)
tukey_result <- pairs(emmeans_result)
tukey_result
letters <- cld(emmeans_result,alpha=0.05)
print(letters)


# Kruskal-Wallis Test
kruskal.test(relative.expression ~ Treatment, data = IGF1.relative.expression.ratio.r1hrmix)

# homogeneity of variances
levene.test <- leveneTest(log2(relative.expression) ~ Treatment, data=IGF1.relative.expression.ratio.r1hrmix)
levene.test

levene.test <- leveneTest(rank(relative.expression) ~ Treatment, data=IGF1.relative.expression.ratio.r1hrmix)
levene.test

# normality
residuals <- resid(IGF1_Gill_twoway_anova_results)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

residuals <- resid(IGF1_Gill_twoway_anova_results_rank)
hist(residuals)
qqnorm(residuals)
shapiro.test(residuals)

#### Boxplots ----------------------------------------------------------------
# sample sizes
sample_sizes <- IGF1.relative.expression.ratio.stats %>%
  group_by(Treatment) %>%
  summarize(SampleSize = n())
sample_sizes

# Tukey labels
custom_labels <- data.frame(
  Treatment = c("1hrCAWS","1hrMix", "1hrRiver", "4hrCAWS", "4hrRiver"))


IGF1.Gill.boxplot <- ggplot(IGF1.relative.expression.ratio.stats, aes(y=log2(relative.expression), x=Treatment)) +
  geom_boxplot() +
  geom_text(data = sample_sizes, aes(x = Treatment, y = -1, label = SampleSize), vjust = -0.5) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  ggtitle ("IGF-1 - Gill")

print(IGF1.Gill.boxplot)

###report stats------------------------------------

IGF1_gill_stats <- IGF1.relative.expression.ratio.stats %>%
  group_by(Pool, Season) %>%
  dplyr::select(c("relative.expression")) %>%
  summarise_all(list(
    "sample_size" = ~ sum(!is.na(.)), # counts only cells with data (i.e., sample size)
    "mean" = ~ mean(., na.rm = TRUE),
    "sd" = ~ sd(., na.rm = TRUE)
  )) 
View(IGF1_gill_stats)

#Gill Figures----------------------------------------
CFOS.relative.expression.ratio.stats$Pool <- factor(CFOS.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
CFOS.relative.expression.ratio.stats$Season <- factor(CFOS.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))
View(CFOS.relative.expression.ratio.stats)

CFOS.gill.boxplot.log2 <- ggplot(CFOS.relative.expression.ratio.stats, 
                                 aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange","red")) +
  scale_y_continuous(limits = c(-8,8)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("A) CFOS") +
  geom_segment(aes(x = 0.6, y = 6.3, xend = 1.4, yend = 6.3), color = "black", size = 2) +
  geom_segment(aes(x = 1.6, y = 3.5, xend = 2.4, yend = 3.5), color = "black", size = 2) +
  annotate("text",x=1,y=7,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=2,y=4.5,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(CFOS.gill.boxplot.log2)

                                       CJUN.relative.expression.ratio.stats$Pool <- factor(CJUN.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
CJUN.relative.expression.ratio.stats$Season <- factor(CJUN.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))
View(CJUN.relative.expression.ratio.stats)

CJUN.gill.boxplot.log2 <- ggplot(CJUN.relative.expression.ratio.stats, 
                                            aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange","red")) +
  scale_y_continuous(limits = c(-6,6)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("B) CJUN") +
  geom_segment(aes(x = 0.6, y = 5.3, xend = 1.4, yend = 5.3), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = 3, xend = 3.4, yend = 3), color = "black", size = 2) +
  geom_segment(aes(x = 1.6, y = 3, xend = 2.4, yend = 3), color = "black", size = 2) +
  annotate("text",x=1,y=5.9,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=4,label=expression(beta),fontface="bold",color="black",size=8) +
  annotate("text",x=2,y=4,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(CJUN.gill.boxplot.log2)

CYP1A.relative.expression.ratio.stats$Pool <- factor(CYP1A.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
CYP1A.relative.expression.ratio.stats$Season <- factor(CYP1A.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

CYP1A.gill.boxplot.log2 <- ggplot(CYP1A.relative.expression.ratio.stats, 
                                 aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange","red")) +
  scale_y_continuous(limits = c(-8,8)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("C) CYP1A") +
  geom_segment(aes(x = 0.6, y = 5, xend = 1.4, yend = 5), color = "black", size = 2) +
  geom_segment(aes(x = 1.6, y = 5.2, xend = 2.4, yend = 5.2), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = 5.2, xend = 3.4, yend = 5.2), color = "black", size = 2) +
  annotate("text",x=1,y=5.6,label=expression(beta),fontface="bold",color="black",size=8) +
  annotate("text",x=2,y=5.7,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=5.7,label=expression(alpha),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(CYP1A.gill.boxplot.log2)

figure.1.rosette <- plot_grid(CFOS.gill.boxplot.log2,
                              CJUN.gill.boxplot.log2,
                              CYP1A.gill.boxplot.log2,
                              ncol=2,nrow=2)

ggsave("Fig1_IR.png", dpi=1200, width = 23, height = 12, units = "in")

#Liver Figures----------------------------------------


###CFOS--------------------------------------------------

CFOS.relative.expression.ratio.stats$Pool <- factor(CFOS.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
CFOS.relative.expression.ratio.stats$Season <- factor(CFOS.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

CFOS.gill.boxplot.log2 <- ggplot(CFOS.relative.expression.ratio.stats, 
                                 aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange", "red")) +
  scale_y_continuous(limits = c(-6,10)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("A) CFOS") +
  annotate("text",x=1,y=8,label="A",fontface="bold",color="orange",size=6) +
  annotate("text",x=2,y=5,label="B",fontface="bold",color="orange",size=6) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(CFOS.gill.boxplot.log2)

###CJUN----------------------------------------

CJUN.relative.expression.ratio.stats$Pool <- factor(CJUN.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
CJUN.relative.expression.ratio.stats$Season <- factor(CJUN.relative.expression.ratio.stats$Season, levels=c("Summer", "Fall"))

CJUN.gill.boxplot.log2 <- ggplot(CJUN.relative.expression.ratio.stats, 
                                 aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("orange", "red")) +
  scale_y_continuous(limits = c(-7,7)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("A) CJUN") +
  geom_segment(aes(x = 0.6, y = 2.25, xend = 1.4, yend = 2.25), color = "black", size = 2) +
  geom_segment(aes(x = 1.6, y = 0.5, xend = 2.4, yend = 0.5), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = 0.5, xend = 3.4, yend = 0.5), color = "black", size = 2) +
  annotate("text",x=1,y=3,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=2,y=1.5,label=expression(beta),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=1.5,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(CJUN.gill.boxplot.log2)

###CK-------------------------------------

CK.relative.expression.ratio.stats$Pool <- factor(CK.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
CK.relative.expression.ratio.stats$Season <- factor(CK.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

CK.gill.boxplot.log2 <- ggplot(CK.relative.expression.ratio.stats, 
                                 aes(y=log2(relative.expression), x = Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange", "red")) +
  scale_y_continuous(limits = c(-15,5)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("B) CK") +
  geom_segment(aes(x = 0.6, y = 3.75, xend = 1.4, yend = 3.75), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = -2, xend = 3.4, yend = -2), color = "black", size = 2) +
  annotate("text",x=1,y=5,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=0,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(CK.gill.boxplot.log2)

###CTRP1--------------------------------------------------

CTRP1.relative.expression.ratio.stats$Pool <- factor(CTRP1.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
CTRP1.relative.expression.ratio.stats$Season <- factor(CTRP1.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

CTRP1.gill.boxplot.log2 <- ggplot(CTRP1.relative.expression.ratio.stats, 
                                 aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange", "red")) +
  scale_y_continuous(limits = c(-6,6)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("C) CTRP1") +
  geom_segment(aes(x = 0.6, y = 4, xend = 1.4, yend = 4), color = "black", size = 2) +
  geom_segment(aes(x = 1.6, y = 4.5, xend = 2.4, yend = 4.5), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = 0.7, xend = 3.4, yend = 0.7), color = "black", size = 2) +
  annotate("text",x=1,y=5,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=2,y=5.5,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=1.5,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(CTRP1.gill.boxplot.log2)

###CYP1A--------------------------------------------------

CYP1A.relative.expression.ratio.stats$Pool <- factor(CYP1A.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
CYP1A.relative.expression.ratio.stats$Season <- factor(CYP1A.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

CYP1A.gill.boxplot.log2 <- ggplot(CYP1A.relative.expression.ratio.stats, 
                                 aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange", "red")) +
  scale_y_continuous(limits = c(-6,10)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("D) CYP1A") +
  geom_segment(aes(x = 1.6, y = 6.5, xend = 2.4, yend = 6.5), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = 4, xend = 3.4, yend = 4), color = "black", size = 2) +
  annotate("text",x=2,y=7.5,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=5,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(CYP1A.gill.boxplot.log2)

###GADD45--------------------------------------------------

GADD45.relative.expression.ratio.stats$Pool <- factor(GADD45.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
GADD45.relative.expression.ratio.stats$Season <- factor(GADD45.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

GADD45.gill.boxplot.log2 <- ggplot(GADD45.relative.expression.ratio.stats, 
                                 aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange", "red")) +
  scale_y_continuous(limits = c(-10,10)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("B) GADD45") +
  annotate("text",x=2.285,y=7,label="A",fontface="bold",color="red",size=6) +
  annotate("text",x=3.285,y=-2,label="B",fontface="bold",color="red",size=6) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(GADD45.gill.boxplot.log2)

###GHR----------------------------------------

GHR.relative.expression.ratio.stats$Pool <- factor(GHR.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
GHR.relative.expression.ratio.stats$Season <- factor(GHR.relative.expression.ratio.stats$Season, levels=c( "Summer", "Fall"))

GHR.gill.boxplot.log2 <- ggplot(GHR.relative.expression.ratio.stats, 
                                 aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("orange", "red")) +
  scale_y_continuous(limits = c(-6,6)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("F) GHR") +
  geom_segment(aes(x = 0.6, y = 3, xend = 1.4, yend = 3), color = "black", size = 2) +
  geom_segment(aes(x = 1.6, y = 4, xend = 2.4, yend = 4), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = 1, xend = 3.4, yend = 1), color = "black", size = 2) +
  annotate("text",x=1,y=4,label=expression(beta),fontface="bold",color="black",size=8) +
  annotate("text",x=2,y=5,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=2,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(GHR.gill.boxplot.log2)

###HIF1a--------------------------------------------------

HIF1a.relative.expression.ratio.stats$Pool <- factor(HIF1a.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
HIF1a.relative.expression.ratio.stats$Season <- factor(HIF1a.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

HIF1a.gill.boxplot.log2 <- ggplot(HIF1a.relative.expression.ratio.stats, 
                                 aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange", "red")) +
  scale_y_continuous(limits = c(-6,6)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("H) HIF1-a") +
  geom_segment(aes(x = 0.6, y = 4, xend = 1.4, yend = 4), color = "black", size = 2) +
  geom_segment(aes(x = 1.6, y = 5, xend = 2.4, yend = 5), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = 1.5, xend = 3.4, yend = 1.5), color = "black", size = 2) +
  annotate("text",x=1,y=4.5,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=2,y=5.5,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=2.25,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(HIF1a.gill.boxplot.log2)

###RAD51--------------------------------------------------

RAD51.relative.expression.ratio.stats$Pool <- factor(RAD51.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
RAD51.relative.expression.ratio.stats$Season <- factor(RAD51.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

RAD51.gill.boxplot.log2 <- ggplot(RAD51.relative.expression.ratio.stats, 
                                   aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange", "red")) +
  scale_y_continuous(limits = c(-8,8)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("C) RAD51") +
  annotate("text",x=2,y=2.5,label="A",fontface="bold",color="orange",size=6) +
  annotate("text",x=3,y=-0.5,label="B",fontface="bold",color="orange",size=6) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(RAD51.gill.boxplot.log2)

###FOX01--------------------------------------------------

FOX01.relative.expression.ratio.stats$Pool <- factor(FOX01.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
FOX01.relative.expression.ratio.stats$Season <- factor(FOX01.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

FOX01.gill.boxplot.log2 <- ggplot(FOX01.relative.expression.ratio.stats, 
                                  aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange", "red")) +
  scale_y_continuous(limits = c(-8,8)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("E) FOX01") +
  geom_segment(aes(x = 0.6, y = 4, xend = 1.4, yend = 4), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = 1.5, xend = 3.4, yend = 1.5), color = "black", size = 2) +
  annotate("text",x=1,y=5,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=2.5,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(FOX01.gill.boxplot.log2)

###GST--------------------------------------------------

GST.relative.expression.ratio.stats$Pool <- factor(GST.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
GST.relative.expression.ratio.stats$Season <- factor(GST.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

GST.gill.boxplot.log2 <- ggplot(GST.relative.expression.ratio.stats, 
                                  aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange", "red")) +
  scale_y_continuous(limits = c(-10,10)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("G) GST") +
  geom_segment(aes(x = 1.6, y = 7, xend = 2.4, yend = 7), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = 3, xend = 3.4, yend = 3), color = "black", size = 2) +
  annotate("text",x=2,y=8,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=4,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(GST.gill.boxplot.log2)

###P53--------------------------------------------------

P53.relative.expression.ratio.stats$Pool <- factor(P53.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
P53.relative.expression.ratio.stats$Season <- factor(P53.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

P53.gill.boxplot.log2 <- ggplot(P53.relative.expression.ratio.stats, 
                                aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange", "red")) +
  scale_y_continuous(limits = c(-8,8)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("I) P53") +
  geom_segment(aes(x = 1.6, y = 5, xend = 2.4, yend = 5), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = 2, xend = 3.4, yend = 2), color = "black", size = 2) +
  annotate("text",x=2,y=6,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=3,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(P53.gill.boxplot.log2)

###SOD1--------------------------------------------------

SOD1.relative.expression.ratio.stats$Pool <- factor(SOD1.relative.expression.ratio.stats$Pool, levels=c("La_Grange", "Starved_Rock", "Dresden_Island"))
SOD1.relative.expression.ratio.stats$Season <- factor(SOD1.relative.expression.ratio.stats$Season, levels=c("Spring", "Summer", "Fall"))

SOD1.gill.boxplot.log2 <- ggplot(SOD1.relative.expression.ratio.stats, 
                                aes(y=log2(relative.expression), x=Pool, color = Season)) +
  geom_boxplot(position = position_dodge(0.85, preserve = "total"),lwd=0.75, outlier.shape = NA)  + 
  geom_point(position=position_jitterdodge(0.5), alpha = 0.3) +
  scale_color_manual(values=c("blue","orange", "red")) +
  scale_y_continuous(limits = c(-8,8)) +
  scale_x_discrete(labels=c("La Grange","Starved Rock","Dresden Island")) +
  ylab("Relative Gene Expression \n (log2 transformed)") +
  ggtitle("J) SOD1") +
  geom_segment(aes(x = 1.6, y = 5.5, xend = 2.4, yend = 5.5), color = "black", size = 2) +
  geom_segment(aes(x = 2.6, y = 2, xend = 3.4, yend = 2), color = "black", size = 2) +
  annotate("text",x=2,y=6.5,label=expression(alpha),fontface="bold",color="black",size=8) +
  annotate("text",x=3,y=3,label=expression(beta),fontface="bold",color="black",size=8) +
  theme(panel.grid = element_blank(), 
        panel.background = element_rect(fill="white", color="white"), 
        axis.title.x = element_blank(),
        axis.line = element_line(size = 1.25, color = "black"),
        axis.ticks.length = unit(0.25,"cm"),
        axis.ticks = element_line(color = "black", size = 1.25),
        axis.text = element_text(face="bold", size=22, color="black"),
        axis.title = element_text(face="bold",size=26, color="black"),
        legend.title = element_blank(),
        legend.position = c(0.9,0.95),
        legend.text = element_text(face="bold",size = 22),
        plot.title = element_text(face="bold",size = 28))
print(SOD1.gill.boxplot.log2)

figure.2 <- plot_grid(CJUN.gill.boxplot.log2,
                      CK.gill.boxplot.log2,
                      CTRP1.gill.boxplot.log2,
                      CYP1A.gill.boxplot.log2,
                      FOX01.gill.boxplot.log2,
                      ncol=3, nrow=2)
                      
ggsave("Fig2_IRR.jpeg", dpi=1200, width = 27, height = 16, units = "in")
                      
figure.2_con <- plot_grid(GHR.gill.boxplot.log2,
                      GST.gill.boxplot.log2,
                      HIF1a.gill.boxplot.log2,
                      P53.gill.boxplot.log2,
                      SOD1.gill.boxplot.log2,
                              ncol=3,nrow=2)

ggsave("Fig2_part2.jpeg", dpi=1200, width = 27, height = 16, units = "in")

Figure.3 <- plot_grid(CFOS.gill.boxplot.log2,
                      GADD45.gill.boxplot.log2,
                      RAD51.gill.boxplot.log2,
                      ncol=2,nrow=2)

ggsave("Fig3_IR.jpeg", dpi=1200, width = 27, height = 16, units = "in")

